/*! For license information please see updatePrices.bundle.js.LICENSE.txt */
(()=>{var e={6(e,t,n){"use strict";var r=n(4702),i=n(488),s=r("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},58(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},100(e,t,n){"use strict";var r=n(9131);e.exports=function(e){return r(e)||null===e}},228(e,t,n){"use strict";var r=n(5457),i=n(7133),s=n(8060),o=n(9272),a=n(7457),c=n(9498),u=i([].push),l=function(e){var t=1===e,n=2===e,i=3===e,l=4===e,h=6===e,d=7===e,f=5===e||h;return function(p,m,g,y){for(var v,w,b=o(p),_=s(b),E=a(_),I=r(m,g),T=0,S=y||c,C=t?S(p,E):n||d?S(p,0):void 0;E>T;T++)if((f||T in _)&&(w=I(v=_[T],T,b),e))if(t)C[T]=w;else if(w)switch(e){case 3:return!0;case 5:return v;case 6:return T;case 2:u(C,v)}else switch(e){case 4:return!1;case 7:u(C,v)}return h?-1:i||l?l:C}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},260(e,t,n){"use strict";var r=n(9140),i=n(942),s=n(8793).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},306(e,t,n){"use strict";var r=n(7133),i=n(2695),s=n(7830),o=n(7720),a=n(3977),c=r(o),u=r("".slice),l=Math.ceil,h=function(e){return function(t,n,r){var o,h,d=s(a(t)),f=i(n),p=d.length,m=void 0===r?" ":s(r);return f<=p||""===m?d:((h=c(m,l((o=f-p)/m.length))).length>o&&(h=u(h,0,o)),e?d+h:h+d)}};e.exports={start:h(!1),end:h(!0)}},335(e,t,n){"use strict";var r=n(6857),i=n(942);e.exports=r&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},404(e,t,n){"use strict";var r=n(3353),i=n(8793),s=n(492),o=n(7133),a=n(1818),c=n(6857),u=n(260),l=n(942),h=n(9158),d=n(2430),f=n(4398),p=n(4360),m=n(2548),g=n(7830),y=n(2007),v=n(2909),w=n(3733),b=n(5809),_=n(5249),E=n(1264),I=n(2428),T=n(4446),S=n(2066),C=n(6732),A=n(8521),k=n(3129),N=n(6014),R=n(2316),O=n(640),x=n(685),P=n(4702),D=n(4990),M=n(9656),L=n(6689),F=n(1606),V=n(1514),U=n(228).forEach,j=R("hidden"),B="Symbol",K="prototype",H=V.set,$=V.getterFor(B),z=Object[K],q=i.Symbol,G=q&&q[K],W=i.RangeError,Y=i.TypeError,Q=i.QObject,J=I.f,X=T.f,Z=_.f,ee=C.f,te=o([].push),ne=N("symbols"),re=N("op-symbols"),ie=N("wks"),se=!Q||!Q[K]||!Q[K].findChild,oe=function(e,t,n){var r=J(z,t);r&&delete z[t],X(e,t,n),r&&e!==z&&X(z,t,r)},ae=c&&l(function(){return 7!==v(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a})?oe:X,ce=function(e,t){var n=ne[e]=v(G);return H(n,{type:B,tag:e,description:t}),c||(n.description=t),n},ue=function(e,t,n){e===z&&ue(re,t,n),f(e);var r=m(t);return f(n),h(ne,r)?(n.enumerable?(h(e,j)&&e[j][r]&&(e[j][r]=!1),n=v(n,{enumerable:y(0,!1)})):(h(e,j)||X(e,j,y(1,v(null))),e[j][r]=!0),ae(e,r,n)):X(e,r,n)},le=function(e,t){f(e);var n=p(t),r=w(n).concat(pe(n));return U(r,function(t){c&&!s(he,n,t)||ue(e,t,n[t])}),e},he=function(e){var t=m(e),n=s(ee,this,t);return!(this===z&&h(ne,t)&&!h(re,t))&&(!(n||!h(this,t)||!h(ne,t)||h(this,j)&&this[j][t])||n)},de=function(e,t){var n=p(e),r=m(t);if(n!==z||!h(ne,r)||h(re,r)){var i=J(n,r);return!i||!h(ne,r)||h(n,j)&&n[j][r]||(i.enumerable=!0),i}},fe=function(e){var t=Z(p(e)),n=[];return U(t,function(e){h(ne,e)||h(O,e)||te(n,e)}),n},pe=function(e){var t=e===z,n=Z(t?re:p(e)),r=[];return U(n,function(e){!h(ne,e)||t&&!h(z,e)||te(r,ne[e])}),r};u||(q=function(){if(d(G,this))throw new Y("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,t=x(e),n=function(e){var r=void 0===this?i:this;r===z&&s(n,re,e),h(r,j)&&h(r[j],t)&&(r[j][t]=!1);var o=y(1,e);try{ae(r,t,o)}catch(e){if(!(e instanceof W))throw e;oe(r,t,o)}};return c&&se&&ae(z,t,{configurable:!0,set:n}),ce(t,e)},A(G=q[K],"toString",function(){return $(this).tag}),A(q,"withoutSetter",function(e){return ce(x(e),e)}),C.f=he,T.f=ue,S.f=le,I.f=de,b.f=_.f=fe,E.f=pe,D.f=function(e){return ce(P(e),e)},c&&(k(G,"description",{configurable:!0,get:function(){return $(this).description}}),a||A(z,"propertyIsEnumerable",he,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!u,sham:!u},{Symbol:q}),U(w(ie),function(e){M(e)}),r({target:B,stat:!0,forced:!u},{useSetter:function(){se=!0},useSimple:function(){se=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!c},{create:function(e,t){return void 0===t?v(e):le(v(e),t)},defineProperty:ue,defineProperties:le,getOwnPropertyDescriptor:de}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:fe}),L(),F(q,B),O[j]=!0},460(e,t,n){"use strict";var r=n(848),i=n(9200),s=n(2430),o=n(6253),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&s(t.prototype,a(e))}},488(e){"use strict";e.exports={}},492(e,t,n){"use strict";var r=n(7315),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},527(e,t,n){"use strict";var r=n(5589),i=n(7133);e.exports=function(e){if("Function"===r(e))return i(e)}},590(e,t,n){"use strict";var r=n(3650),i=n(9325),s=n(2178),o=n(488),a=n(4702)("iterator");e.exports=function(e){if(!s(e))return i(e,a)||i(e,"@@iterator")||o[r(e)]}},640(e){"use strict";e.exports={}},685(e,t,n){"use strict";var r=n(7133),i=0,s=Math.random(),o=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},709(e,t,n){"use strict";var r=n(3353),i=n(306).start;r({target:"String",proto:!0,forced:n(3898)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},824(e,t,n){"use strict";var r=n(8793).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},848(e,t,n){"use strict";var r=n(8793),i=n(9200);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},890(e,t,n){"use strict";var r=n(7315),i=Function.prototype,s=i.apply,o=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})},917(e,t,n){"use strict";var r={};r[n(4702)("toStringTag")]="z",e.exports="[object z]"===String(r)},942(e){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},957(e,t,n){"use strict";var r=n(492),i=n(4398),s=n(9200),o=n(5589),a=n(4762),c=TypeError;e.exports=function(e,t){var n=e.exec;if(s(n)){var u=r(n,e,t);return null!==u&&i(u),u}if("RegExp"===o(e))return r(a,e,t);throw new c("RegExp#exec called on incompatible receiver")}},1150(e,t,n){"use strict";var r=n(8793),i=n(942),s=r.RegExp,o=!i(function(){var e=!0;try{s(".","d")}catch(t){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",i=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in e&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(s.prototype,"flags").get.call(t)!==r||n!==r});e.exports={correct:o}},1264(e,t){"use strict";t.f=Object.getOwnPropertySymbols},1427(e,t,n){"use strict";var r=n(492),i=n(9200),s=n(9131),o=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!s(a=r(n,e)))return a;if(i(n=e.valueOf)&&!s(a=r(n,e)))return a;if("string"!==t&&i(n=e.toString)&&!s(a=r(n,e)))return a;throw new o("Can't convert object to primitive value")}},1466(e,t,n){"use strict";var r=n(8793),i=n(9131),s=r.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},1497(e,t,n){"use strict";var r=n(3353),i=n(9158),s=n(460),o=n(7938),a=n(6014),c=n(6325),u=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(e){if(!s(e))throw new TypeError(o(e)+" is not a symbol");if(i(u,e))return u[e]}})},1512(e,t,n){"use strict";var r=n(4398),i=n(9400);e.exports=function(e,t,n,s){try{return s?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},1514(e,t,n){"use strict";var r,i,s,o=n(3125),a=n(8793),c=n(9131),u=n(5044),l=n(9158),h=n(5210),d=n(2316),f=n(640),p="Object already initialized",m=a.TypeError,g=a.WeakMap;if(o||h.state){var y=h.state||(h.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,r=function(e,t){if(y.has(e))throw new m(p);return t.facade=e,y.set(e,t),t},i=function(e){return y.get(e)||{}},s=function(e){return y.has(e)}}else{var v=d("state");f[v]=!0,r=function(e,t){if(l(e,v))throw new m(p);return t.facade=e,u(e,v,t),t},i=function(e){return l(e,v)?e[v]:{}},s=function(e){return l(e,v)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},1606(e,t,n){"use strict";var r=n(4446).f,i=n(9158),s=n(4702)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,s)&&r(e,s,{configurable:!0,value:t})}},1724(e,t,n){"use strict";n(9656)("iterator")},1778(e,t,n){"use strict";var r=n(492),i=n(2365),s=n(4398),o=n(7938),a=n(590),c=TypeError;e.exports=function(e,t){var n=arguments.length<2?a(e):t;if(i(n))return s(r(n,e));throw new c(o(e)+" is not iterable")}},1818(e){"use strict";e.exports=!1},1982(e,t,n){"use strict";var r,i,s,o=n(942),a=n(9200),c=n(9131),u=n(2909),l=n(5270),h=n(8521),d=n(4702),f=n(1818),p=d("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=l(l(s)))!==Object.prototype&&(r=i):m=!0),!c(r)||o(function(){var e={};return r[p].call(e)!==e})?r={}:f&&(r=u(r)),a(r[p])||h(r,p,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},2007(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},2030(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2040(e,t,n){"use strict";var r=n(228).forEach,i=n(5977)("forEach");e.exports=i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},2062(e,t,n){"use strict";var r=n(3353),i=n(260),s=n(942),o=n(1264),a=n(9272);r({target:"Object",stat:!0,forced:!i||s(function(){o.f(1)})},{getOwnPropertySymbols:function(e){var t=o.f;return t?t(a(e)):[]}})},2066(e,t,n){"use strict";var r=n(6857),i=n(335),s=n(4446),o=n(4398),a=n(4360),c=n(3733);t.f=r&&!i?Object.defineProperties:function(e,t){o(e);for(var n,r=a(t),i=c(t),u=i.length,l=0;u>l;)s.f(e,n=i[l++],r[n]);return e}},2178(e){"use strict";e.exports=function(e){return null==e}},2210(e,t,n){"use strict";var r=n(9200),i=n(9131),s=n(8018);e.exports=function(e,t,n){var o,a;return s&&r(o=t.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(e,a),e}},2316(e,t,n){"use strict";var r=n(6014),i=n(685),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},2365(e,t,n){"use strict";var r=n(9200),i=n(7938),s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not a function")}},2428(e,t,n){"use strict";var r=n(6857),i=n(492),s=n(6732),o=n(2007),a=n(4360),c=n(2548),u=n(9158),l=n(5842),h=Object.getOwnPropertyDescriptor;t.f=r?h:function(e,t){if(e=a(e),t=c(t),l)try{return h(e,t)}catch(e){}if(u(e,t))return o(!i(s.f,e,t),e[t])}},2430(e,t,n){"use strict";var r=n(7133);e.exports=r({}.isPrototypeOf)},2485(e,t,n){"use strict";var r=n(7133);e.exports=r([].slice)},2548(e,t,n){"use strict";var r=n(9422),i=n(460);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2580(e,t,n){"use strict";var r=n(3353),i=n(4762);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},2582(e,t,n){"use strict";var r=n(3353),i=n(8793),s=n(6575)(i.setTimeout,!0);r({global:!0,bind:!0,forced:i.setTimeout!==s},{setTimeout:s})},2584(e,t,n){"use strict";n(9908),n(2582)},2625(e){function t(n,r,i,s){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}e.exports=t=function(e,n,r,i){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!i,configurable:!i,writable:!i}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,i,s)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2695(e,t,n){"use strict";var r=n(4932),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},2909(e,t,n){"use strict";var r,i=n(4398),s=n(2066),o=n(2030),a=n(640),c=n(4510),u=n(1466),l=n(2316),h="prototype",d="script",f=l("IE_PROTO"),p=function(){},m=function(e){return"<"+d+">"+e+"</"+d+">"},g=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;y="undefined"!=typeof document?document.domain&&r?g(r):(t=u("iframe"),n="java"+d+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):g(r);for(var i=o.length;i--;)delete y[h][o[i]];return y()};a[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(p[h]=i(e),n=new p,p[h]=null,n[f]=e):n=y(),void 0===t?n:s.f(n,t)}},2971(e,t,n){var r=n(8636)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},2997(e){"use strict";e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},3111(e,t,n){"use strict";var r=n(8793),i=n(3217),s=n(5827),o=n(2040),a=n(5044),c=function(e){if(e&&e.forEach!==o)try{a(e,"forEach",o)}catch(t){e.forEach=o}};for(var u in i)i[u]&&c(r[u]&&r[u].prototype);c(s)},3125(e,t,n){"use strict";var r=n(8793),i=n(9200),s=r.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},3129(e,t,n){"use strict";var r=n(4174),i=n(4446);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),i.f(e,t,n)}},3217(e){"use strict";e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3353(e,t,n){"use strict";var r=n(8793),i=n(2428).f,s=n(5044),o=n(8521),a=n(8466),c=n(4085),u=n(7453);e.exports=function(e,t){var n,l,h,d,f,p=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[p]||a(p,{}):r[p]&&r[p].prototype)for(l in t){if(d=t[l],h=e.dontCallGetSet?(f=i(n,l))&&f.value:n[l],!u(m?l:p+(g?".":"#")+l,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;c(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),o(n,l,d,e)}}},3358(e,t,n){"use strict";var r=n(942),i=n(4702),s=n(9140),o=i("species");e.exports=function(e){return s>=51||!r(function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo})}},3519(e,t,n){"use strict";var r=n(9131),i=n(1514).get;e.exports=function(e){if(!r(e))return!1;var t=i(e);return!!t&&"RawJSON"===t.type}},3614(e,t,n){"use strict";var r=n(7133),i=n(942),s=n(9200),o=n(3650),a=n(848),c=n(7217),u=function(){},l=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),f=!h.test(u),p=function(e){if(!s(e))return!1;try{return l(u,[],e),!0}catch(e){return!1}},m=function(e){if(!s(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(h,c(e))}catch(e){return!0}};m.sham=!0,e.exports=!l||i(function(){var e;return p(p.call)||!p(Object)||!p(function(){e=!0})||e})?m:p},3650(e,t,n){"use strict";var r=n(917),i=n(9200),s=n(5589),o=n(4702)("toStringTag"),a=Object,c="Arguments"===s(function(){return arguments}());e.exports=r?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=a(e),o))?n:c?s(t):"Object"===(r=s(t))&&i(t.callee)?"Arguments":r}},3733(e,t,n){"use strict";var r=n(8959),i=n(2030);e.exports=Object.keys||function(e){return r(e,i)}},3898(e,t,n){"use strict";var r=n(824);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},3977(e,t,n){"use strict";var r=n(2178),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},4026(e,t,n){"use strict";var r=n(942);e.exports=!r(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e})},4085(e,t,n){"use strict";var r=n(9158),i=n(4540),s=n(2428),o=n(4446);e.exports=function(e,t,n){for(var a=i(t),c=o.f,u=s.f,l=0;l<a.length;l++){var h=a[l];r(e,h)||n&&r(n,h)||c(e,h,u(t,h))}}},4174(e,t,n){"use strict";var r=n(7133),i=n(942),s=n(9200),o=n(9158),a=n(6857),c=n(7403).CONFIGURABLE,u=n(7217),l=n(1514),h=l.enforce,d=l.get,f=String,p=Object.defineProperty,m=r("".slice),g=r("".replace),y=r([].join),v=a&&!i(function(){return 8!==p(function(){},"length",{value:8}).length}),w=String(String).split("String"),b=e.exports=function(e,t,n){"Symbol("===m(f(t),0,7)&&(t="["+g(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!o(e,"name")||c&&e.name!==t)&&(a?p(e,"name",{value:t,configurable:!0}):e.name=t),v&&n&&o(n,"arity")&&e.length!==n.arity&&p(e,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&p(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=h(e);return o(r,"source")||(r.source=y(w,"string"==typeof t?t:"")),e};Function.prototype.toString=b(function(){return s(this)&&d(this).source||u(this)},"toString")},4202(e,t,n){"use strict";var r=n(917),i=n(8521),s=n(6952);r||i(Object.prototype,"toString",s,{unsafe:!0})},4360(e,t,n){"use strict";var r=n(8060),i=n(3977);e.exports=function(e){return r(i(e))}},4398(e,t,n){"use strict";var r=n(9131),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s(i(e)+" is not an object")}},4446(e,t,n){"use strict";var r=n(6857),i=n(5842),s=n(335),o=n(4398),a=n(2548),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";t.f=r?s?function(e,t,n){if(o(e),t=a(t),o(n),"function"==typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var r=l(e,t);r&&r[f]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(o(e),t=a(t),o(n),i)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},4510(e,t,n){"use strict";var r=n(848);e.exports=r("document","documentElement")},4540(e,t,n){"use strict";var r=n(848),i=n(7133),s=n(5809),o=n(1264),a=n(4398),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(a(e)),n=o.f;return n?c(t,n(e)):t}},4635(e,t,n){"use strict";var r=n(1982).IteratorPrototype,i=n(2909),s=n(2007),o=n(1606),a=n(488),c=function(){return this};e.exports=function(e,t,n,u){var l=t+" Iterator";return e.prototype=i(r,{next:s(+!u,n)}),o(e,l,!1,!0),a[l]=c,e}},4686(e){"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},4702(e,t,n){"use strict";var r=n(8793),i=n(6014),s=n(9158),o=n(685),a=n(260),c=n(6253),u=r.Symbol,l=i("wks"),h=c?u.for||u:u&&u.withoutSetter||o;e.exports=function(e){return s(l,e)||(l[e]=a&&s(u,e)?u[e]:h("Symbol."+e)),l[e]}},4762(e,t,n){"use strict";var r,i,s=n(492),o=n(7133),a=n(7830),c=n(9824),u=n(9260),l=n(6014),h=n(2909),d=n(1514).get,f=n(7432),p=n(6437),m=l("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,y=g,v=o("".charAt),w=o("".indexOf),b=o("".replace),_=o("".slice),E=(i=/b*/g,s(g,r=/a/,"a"),s(g,i,"a"),0!==r.lastIndex||0!==i.lastIndex),I=u.BROKEN_CARET,T=void 0!==/()??/.exec("")[1];(E||T||I||f||p)&&(y=function(e){var t,n,r,i,o,u,l,f=this,p=d(f),S=a(e),C=p.raw;if(C)return C.lastIndex=f.lastIndex,t=s(y,C,S),f.lastIndex=C.lastIndex,t;var A=p.groups,k=I&&f.sticky,N=s(c,f),R=f.source,O=0,x=S;if(k&&(N=b(N,"y",""),-1===w(N,"g")&&(N+="g"),x=_(S,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==v(S,f.lastIndex-1))&&(R="(?: "+R+")",x=" "+x,O++),n=new RegExp("^(?:"+R+")",N)),T&&(n=new RegExp("^"+R+"$(?!\\s)",N)),E&&(r=f.lastIndex),i=s(g,k?n:f,x),k?i?(i.input=_(i.input,O),i[0]=_(i[0],O),i.index=f.lastIndex,f.lastIndex+=i[0].length):f.lastIndex=0:E&&i&&(f.lastIndex=f.global?i.index+i[0].length:r),T&&i&&i.length>1&&s(m,i[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)}),i&&A)for(i.groups=u=h(null),o=0;o<A.length;o++)u[(l=A[o])[0]]=i[l[1]];return i}),e.exports=y},4845(e,t,n){"use strict";var r=n(3353),i=n(9323),s=n(3614),o=n(9131),a=n(8479),c=n(7457),u=n(4360),l=n(5909),h=n(4702),d=n(3358),f=n(2485),p=d("slice"),m=h("species"),g=Array,y=Math.max;r({target:"Array",proto:!0,forced:!p},{slice:function(e,t){var n,r,h,d=u(this),p=c(d),v=a(e,p),w=a(void 0===t?p:t,p);if(i(d)&&(n=d.constructor,(s(n)&&(n===g||i(n.prototype))||o(n)&&null===(n=n[m]))&&(n=void 0),n===g||void 0===n))return f(d,v,w);for(r=new(void 0===n?g:n)(y(w-v,0)),h=0;v<w;v++,h++)v in d&&l(r,h,d[v]);return r.length=h,r}})},4932(e,t,n){"use strict";var r=n(8226);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},4990(e,t,n){"use strict";var r=n(4702);t.f=r},5006(e){"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},5044(e,t,n){"use strict";var r=n(6857),i=n(4446),s=n(2007);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},5119(e,t,n){"use strict";n(2580);var r=n(492),i=n(8521),s=n(4762),o=n(942),a=n(4702),c=n(5044),u=a("species"),l=RegExp.prototype;e.exports=function(e,t,n,h){var d=a(e),f=!o(function(){var t={};return t[d]=function(){return 7},7!==""[e](t)}),p=f&&!o(function(){var t=!1,n=/a/;if("split"===e){var r={};r[u]=function(){return n},(n={constructor:r,flags:""})[d]=/./[d]}return n.exec=function(){return t=!0,null},n[d](""),!t});if(!f||!p||n){var m=/./[d],g=t(d,""[e],function(e,t,n,i,o){var a=t.exec;return a===s||a===l.exec?f&&!o?{done:!0,value:r(m,t,n,i)}:{done:!0,value:r(e,n,t,i)}:{done:!1}});i(String.prototype,e,g[0]),i(l,d,g[1])}h&&c(l[d],"sham",!0)}},5132(e,t,n){var r=n(7986),i=n(7362);e.exports=function(e,t,n,s,o){return new i(r().w(e,t,n,s),o||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},5133(e,t,n){"use strict";var r=n(3353),i=n(1818),s=n(6857),o=n(8793),a=n(7596),c=n(7133),u=n(7453),l=n(9158),h=n(2210),d=n(2430),f=n(460),p=n(9422),m=n(942),g=n(5809).f,y=n(2428).f,v=n(4446).f,w=n(5949),b=n(7087).trim,_="Number",E=o[_],I=a[_],T=E.prototype,S=o.TypeError,C=c("".slice),A=c("".charCodeAt),k=u(_,!E(" 0o1")||!E("0b1")||E("+0x1")),N=function(e){var t,n=arguments.length<1?0:E(function(e){var t=p(e,"number");return"bigint"==typeof t?t:function(e){var t,n,r,i,s,o,a,c,u=p(e,"number");if(f(u))throw new S("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=b(u),43===(t=A(u,0))||45===t){if(88===(n=A(u,2))||120===n)return NaN}else if(48===t){switch(A(u,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=(s=C(u,2)).length,a=0;a<o;a++)if((c=A(s,a))<48||c>i)return NaN;return parseInt(s,r)}return+u}(t)}(e));return d(T,t=this)&&m(function(){w(t)})?h(Object(n),this,N):n};N.prototype=T,k&&!i&&(T.constructor=N),r({global:!0,constructor:!0,wrap:!0,forced:k},{Number:N});var R=function(e,t){for(var n,r=s?g(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;r.length>i;i++)l(t,n=r[i])&&!l(e,n)&&v(e,n,y(t,n))};i&&I&&R(a[_],I),(k||i)&&R(a[_],E)},5185(e,t,n){"use strict";var r=n(890),i=n(492),s=n(7133),o=n(5119),a=n(942),c=n(4398),u=n(9200),l=n(9131),h=n(4932),d=n(2695),f=n(7830),p=n(3977),m=n(8718),g=n(9325),y=n(8965),v=n(7781),w=n(957),b=n(4702)("replace"),_=Math.max,E=Math.min,I=s([].concat),T=s([].push),S=s("".indexOf),C=s("".slice),A=function(e){return void 0===e?e:String(e)},k="$0"==="a".replace(/./,"$0"),N=!!/./[b]&&""===/./[b]("a","$0");o("replace",function(e,t,n){var s=N?"$":"$0";return[function(e,n){var r=p(this),s=l(e)?g(e,b):void 0;return s?i(s,e,r,n):i(t,f(r),e,n)},function(e,i){var o=c(this),a=f(e);if("string"==typeof i&&-1===S(i,s)&&-1===S(i,"$<")){var l=n(t,o,a,i);if(l.done)return l.value}var p=u(i);p||(i=f(i));var g,b=f(v(o)),k=-1!==S(b,"g");k&&(g=-1!==S(b,"u"),o.lastIndex=0);for(var N,R=[];null!==(N=w(o,a))&&(T(R,N),k);)""===f(N[0])&&(o.lastIndex=m(a,d(o.lastIndex),g));for(var O="",x=0,P=0;P<R.length;P++){for(var D,M=f((N=R[P])[0]),L=_(E(h(N.index),a.length),0),F=[],V=1;V<N.length;V++)T(F,A(N[V]));var U=N.groups;if(p){var j=I([M],F,L,a);void 0!==U&&T(j,U),D=f(r(i,void 0,j))}else D=y(M,a,L,F,U,i);L>=x&&(O+=C(a,x,L)+D,x=L+M.length)}return O+C(a,x)}]},!!a(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!k||N)},5210(e,t,n){"use strict";var r=n(1818),i=n(8793),s=n(8466),o="__core-js_shared__",a=e.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.47.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5249(e,t,n){"use strict";var r=n(5589),i=n(4360),s=n(5809).f,o=n(2485),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"Window"===r(e)?function(e){try{return s(e)}catch(e){return o(a)}}(e):s(i(e))}},5270(e,t,n){"use strict";var r=n(9158),i=n(9200),s=n(9272),o=n(2316),a=n(6308),c=o("IE_PROTO"),u=Object,l=u.prototype;e.exports=a?u.getPrototypeOf:function(e){var t=s(e);if(r(t,c))return t[c];var n=t.constructor;return i(n)&&t instanceof n?n.prototype:t instanceof u?l:null}},5457(e,t,n){"use strict";var r=n(527),i=n(2365),s=n(7315),o=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:s?o(e,t):function(){return e.apply(t,arguments)}}},5503(e,t,n){"use strict";var r=n(3353),i=n(7133),s=n(4932),o=n(5949),a=n(7720),c=n(942),u=RangeError,l=String,h=Math.floor,d=i(a),f=i("".slice),p=i(1.1.toFixed),m=function(e,t,n){return 0===t?n:t%2==1?m(e,t-1,n*e):m(e*e,t/2,n)},g=function(e,t,n){for(var r=-1,i=n;++r<6;)i+=t*e[r],e[r]=i%1e7,i=h(i/1e7)},y=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=h(r/t),r=r%t*1e7},v=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=l(e[t]);n=""===n?r:n+d("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:c(function(){return"0.000"!==p(8e-5,3)||"1"!==p(.9,0)||"1.25"!==p(1.255,2)||"1000000000000000128"!==p(0xde0b6b3a7640080,0)})||!c(function(){p({})})},{toFixed:function(e){var t,n,r,i,a=o(this),c=s(e),h=[0,0,0,0,0,0],p="",w="0";if(c<0||c>20)throw new u("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return l(a);if(a<0&&(p="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*m(2,69,1))-69)<0?a*m(2,-t,1):a/m(2,t,1),n*=4503599627370496,(t=52-t)>0){for(g(h,0,n),r=c;r>=7;)g(h,1e7,0),r-=7;for(g(h,m(10,r,1),0),r=t-1;r>=23;)y(h,1<<23),r-=23;y(h,1<<r),g(h,1,1),y(h,2),w=v(h)}else g(h,0,n),g(h,1<<-t,0),w=v(h)+d("0",c);return c>0?p+((i=w.length)<=c?"0."+d("0",c-i)+w:f(w,0,i-c)+"."+f(w,i-c)):p+w}})},5535(e,t,n){"use strict";var r=n(9944).charAt,i=n(7830),s=n(1514),o=n(7645),a=n(7236),c="String Iterator",u=s.set,l=s.getterFor(c);o(String,"String",function(e){u(this,{type:c,string:i(e),index:0})},function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?a(void 0,!0):(e=r(n,i),t.index+=e.length,a(e,!1))})},5589(e,t,n){"use strict";var r=n(7133),i=r({}.toString),s=r("".slice);e.exports=function(e){return s(i(e),8,-1)}},5809(e,t,n){"use strict";var r=n(8959),i=n(2030).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},5827(e,t,n){"use strict";var r=n(1466)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},5842(e,t,n){"use strict";var r=n(6857),i=n(942),s=n(1466);e.exports=!r&&!i(function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a})},5898(e,t,n){"use strict";var r=n(8793),i=n(824),s=n(5589),o=function(e){return i.slice(0,e.length)===e};e.exports=o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},5909(e,t,n){"use strict";var r=n(6857),i=n(4446),s=n(2007);e.exports=function(e,t,n){r?i.f(e,t,s(0,n)):e[t]=n}},5949(e,t,n){"use strict";var r=n(7133);e.exports=r(1.1.valueOf)},5977(e,t,n){"use strict";var r=n(942);e.exports=function(e,t){var n=[][e];return!!n&&r(function(){n.call(null,t||function(){return 1},1)})}},6014(e,t,n){"use strict";var r=n(5210);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},6134(e,t,n){"use strict";var r=n(4360),i=n(8479),s=n(7457),o=function(e){return function(t,n,o){var a=r(t),c=s(a);if(0===c)return!e&&-1;var u,l=i(o,c);if(e&&n!=n){for(;c>l;)if((u=a[l++])!=u)return!0}else for(;c>l;l++)if((e||l in a)&&a[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},6216(e,t,n){"use strict";var r=n(3353),i=n(228).find,s=n(6686),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},6253(e,t,n){"use strict";var r=n(260);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},6308(e,t,n){"use strict";var r=n(942);e.exports=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},6325(e,t,n){"use strict";var r=n(260);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},6345(e,t,n){"use strict";var r=n(6857),i=n(7403).EXISTS,s=n(7133),o=n(3129),a=Function.prototype,c=s(a.toString),u=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=s(u.exec);r&&!i&&o(a,"name",{configurable:!0,get:function(){try{return l(u,c(this))[1]}catch(e){return""}}})},6367(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},6391(e,t,n){"use strict";var r=n(3353),i=n(848),s=n(9158),o=n(7830),a=n(6014),c=n(6325),u=a("string-to-symbol-registry"),l=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(e){var t=o(e);if(s(u,t))return u[t];var n=i("Symbol")(t);return u[t]=n,l[n]=t,n}})},6437(e,t,n){"use strict";var r=n(942),i=n(8793).RegExp;e.exports=r(function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})},6575(e,t,n){"use strict";var r,i=n(8793),s=n(890),o=n(9200),a=n(5898),c=n(824),u=n(2485),l=n(5006),h=i.Function,d=/MSIE .\./.test(c)||"BUN"===a&&((r=i.Bun.version.split(".")).length<3||"0"===r[0]&&(r[1]<3||"3"===r[1]&&"0"===r[2]));e.exports=function(e,t){var n=t?2:1;return d?function(r,i){var a=l(arguments.length,1)>n,c=o(r)?r:h(r),d=a?u(arguments,n):[],f=a?function(){s(c,this,d)}:c;return t?e(f,i):e(f)}:e}},6657(e,t,n){"use strict";var r,i=n(3353),s=n(527),o=n(2428).f,a=n(2695),c=n(7830),u=n(8456),l=n(3977),h=n(9253),d=n(1818),f=s("".slice),p=Math.min,m=h("startsWith");i({target:"String",proto:!0,forced:!(!d&&!m&&(r=o(String.prototype,"startsWith"),r&&!r.writable)||m)},{startsWith:function(e){var t=c(l(this));u(e);var n=a(p(arguments.length>1?arguments[1]:void 0,t.length)),r=c(e);return f(t,n,n+r.length)===r}})},6686(e,t,n){"use strict";var r=n(4702),i=n(2909),s=n(4446).f,o=r("unscopables"),a=Array.prototype;void 0===a[o]&&s(a,o,{configurable:!0,value:i(null)}),e.exports=function(e){a[o][e]=!0}},6689(e,t,n){"use strict";var r=n(492),i=n(848),s=n(4702),o=n(8521);e.exports=function(){var e=i("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,a=s("toPrimitive");t&&!t[a]&&o(t,a,function(e){return r(n,this)},{arity:1})}},6732(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},6760(e,t,n){"use strict";var r=n(9323),i=n(3614),s=n(9131),o=n(4702)("species"),a=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(i(t)&&(t===a||r(t.prototype))||s(t)&&null===(t=t[o]))&&(t=void 0)),void 0===t?a:t}},6857(e,t,n){"use strict";var r=n(942);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},6903(e,t,n){"use strict";var r=n(3353),i=n(9468);r({target:"Array",stat:!0,forced:!n(9671)(function(e){Array.from(e)})},{from:i})},6952(e,t,n){"use strict";var r=n(917),i=n(3650);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},7087(e,t,n){"use strict";var r=n(7133),i=n(3977),s=n(7830),o=n(2997),a=r("".replace),c=RegExp("^["+o+"]+"),u=RegExp("(^|[^"+o+"])["+o+"]+$"),l=function(e){return function(t){var n=s(i(t));return 1&e&&(n=a(n,c,"")),2&e&&(n=a(n,u,"$1")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},7133(e,t,n){"use strict";var r=n(7315),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);e.exports=r?o:function(e){return function(){return s.apply(e,arguments)}}},7217(e,t,n){"use strict";var r=n(7133),i=n(9200),s=n(5210),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},7231(e,t,n){"use strict";var r=n(3353),i=n(942),s=n(9323),o=n(9131),a=n(9272),c=n(7457),u=n(4686),l=n(5909),h=n(9498),d=n(3358),f=n(4702),p=n(9140),m=f("isConcatSpreadable"),g=p>=51||!i(function(){var e=[];return e[m]=!1,e.concat()[0]!==e}),y=function(e){if(!o(e))return!1;var t=e[m];return void 0!==t?!!t:s(e)};r({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(e){var t,n,r,i,s,o=a(this),d=h(o,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(y(s=-1===t?o:arguments[t]))for(i=c(s),u(f+i),n=0;n<i;n++,f++)n in s&&l(d,f,s[n]);else u(f+1),l(d,f++,s);return d.length=f,d}})},7234(e,t,n){"use strict";var r=n(3353),i=n(6857),s=n(8793),o=n(7133),a=n(9158),c=n(9200),u=n(2430),l=n(7830),h=n(3129),d=n(4085),f=s.Symbol,p=f&&f.prototype;if(i&&c(f)&&(!("description"in p)||void 0!==f().description)){var m={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=u(p,this)?new f(e):void 0===e?f():f(e);return""===e&&(m[t]=!0),t};d(g,f),g.prototype=p,p.constructor=g;var y="Symbol(description detection)"===String(f("description detection")),v=o(p.valueOf),w=o(p.toString),b=/^Symbol\((.*)\)[^)]+$/,_=o("".replace),E=o("".slice);h(p,"description",{configurable:!0,get:function(){var e=v(this);if(a(m,e))return"";var t=w(e),n=y?E(t,7,-1):_(t,b,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:g})}},7236(e){"use strict";e.exports=function(e,t){return{value:e,done:t}}},7285(e,t,n){"use strict";var r=n(9131),i=n(5589),s=n(4702)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"===i(e))}},7315(e,t,n){"use strict";var r=n(942);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},7362(e,t,n){var r=n(6367),i=n(2625);e.exports=function e(t,n){function s(e,i,o,a){try{var c=t[e](i),u=c.value;return u instanceof r?n.resolve(u.v).then(function(e){s("next",e,o,a)},function(e){s("throw",e,o,a)}):n.resolve(u).then(function(e){c.value=e,o(c)},function(e){return s("throw",e,o,a)})}catch(e){a(e)}}var o;this.next||(i(e.prototype),i(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),i(this,"_invoke",function(e,t,r){function i(){return new n(function(t,n){s(e,r,t,n)})}return o=o?o.then(i,i):i()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},7403(e,t,n){"use strict";var r=n(6857),i=n(9158),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},7432(e,t,n){"use strict";var r=n(942),i=n(8793).RegExp;e.exports=r(function(){var e=i(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)})},7453(e,t,n){"use strict";var r=n(942),i=n(9200),s=/#|\.prototype\./,o=function(e,t){var n=c[a(e)];return n===l||n!==u&&(i(t)?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=o.data={},u=o.NATIVE="N",l=o.POLYFILL="P";e.exports=o},7457(e,t,n){"use strict";var r=n(2695);e.exports=function(e){return r(e.length)}},7596(e,t,n){"use strict";var r=n(8793);e.exports=r},7645(e,t,n){"use strict";var r=n(3353),i=n(492),s=n(1818),o=n(7403),a=n(9200),c=n(4635),u=n(5270),l=n(8018),h=n(1606),d=n(5044),f=n(8521),p=n(4702),m=n(488),g=n(1982),y=o.PROPER,v=o.CONFIGURABLE,w=g.IteratorPrototype,b=g.BUGGY_SAFARI_ITERATORS,_=p("iterator"),E="keys",I="values",T="entries",S=function(){return this};e.exports=function(e,t,n,o,p,g,C){c(n,t,o);var A,k,N,R=function(e){if(e===p&&M)return M;if(!b&&e&&e in P)return P[e];switch(e){case E:case I:case T:return function(){return new n(this,e)}}return function(){return new n(this)}},O=t+" Iterator",x=!1,P=e.prototype,D=P[_]||P["@@iterator"]||p&&P[p],M=!b&&D||R(p),L="Array"===t&&P.entries||D;if(L&&(A=u(L.call(new e)))!==Object.prototype&&A.next&&(s||u(A)===w||(l?l(A,w):a(A[_])||f(A,_,S)),h(A,O,!0,!0),s&&(m[O]=S)),y&&p===I&&D&&D.name!==I&&(!s&&v?d(P,"name",I):(x=!0,M=function(){return i(D,this)})),p)if(k={values:R(I),keys:g?M:R(E),entries:R(T)},C)for(N in k)(b||x||!(N in P))&&f(P,N,k[N]);else r({target:t,proto:!0,forced:b||x},k);return s&&!C||P[_]===M||f(P,_,M,{name:p}),m[t]=M,k}},7720(e,t,n){"use strict";var r=n(4932),i=n(7830),s=n(3977),o=RangeError;e.exports=function(e){var t=i(s(this)),n="",a=r(e);if(a<0||a===1/0)throw new o("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(n+=t);return n}},7781(e,t,n){"use strict";var r=n(492),i=n(9158),s=n(2430),o=n(1150),a=n(9824),c=RegExp.prototype;e.exports=o.correct?function(e){return e.flags}:function(e){return o.correct||!s(c,e)||i(e,"flags")?e.flags:r(a,e)}},7830(e,t,n){"use strict";var r=n(3650),i=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return i(e)}},7933(e,t,n){"use strict";var r=n(4360),i=n(6686),s=n(488),o=n(1514),a=n(4446).f,c=n(7645),u=n(7236),l=n(1818),h=n(6857),d="Array Iterator",f=o.set,p=o.getterFor(d);e.exports=c(Array,"Array",function(e,t){f(this,{type:d,target:r(e),index:0,kind:t})},function(){var e=p(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,u(void 0,!0);switch(e.kind){case"keys":return u(n,!1);case"values":return u(t[n],!1)}return u([n,t[n]],!1)},"values");var m=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!l&&h&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(e){}},7938(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},7986(e,t,n){var r=n(2625);function i(){var t,n,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.toStringTag||"@@toStringTag";function c(e,i,s,o){var a=i&&i.prototype instanceof l?i:l,c=Object.create(a.prototype);return r(c,"_invoke",function(e,r,i){var s,o,a,c=0,l=i||[],h=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return s=e,o=0,a=t,d.n=n,u}};function f(e,r){for(o=e,a=r,n=0;!h&&c&&!i&&n<l.length;n++){var i,s=l[n],f=d.p,p=s[2];e>3?(i=p===r)&&(a=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=t):s[0]<=f&&((i=e<2&&f<s[1])?(o=0,d.v=r,d.n=s[1]):f<p&&(i=e<3||s[0]>r||r>p)&&(s[4]=e,s[5]=r,d.n=p,o=0))}if(i||e>1)return u;throw h=!0,r}return function(i,l,p){if(c>1)throw TypeError("Generator is already running");for(h&&1===l&&f(l,p),o=l,a=p;(n=o<2?t:a)||!h;){s||(o?o<3?(o>1&&(d.n=-1),f(o,a)):d.n=a:d.v=a);try{if(c=2,s){if(o||(i="next"),n=s[i]){if(!(n=n.call(s,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),o=1);s=t}else if((n=(h=d.n<0)?a:e.call(r,d))!==u)break}catch(e){s=t,o=1,a=e}finally{c=1}}return{value:n,done:h}}}(e,s,o),!0),c}var u={};function l(){}function h(){}function d(){}n=Object.getPrototypeOf;var f=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),p=d.prototype=l.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return h.prototype=d,r(p,"constructor",d),r(d,"constructor",h),h.displayName="GeneratorFunction",r(d,a,"GeneratorFunction"),r(p),r(p,a,"Generator"),r(p,o,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(e.exports=i=function(){return{w:c,m}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},8018(e,t,n){"use strict";var r=n(9229),i=n(9131),s=n(3977),o=n(9677);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return s(n),o(r),i(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},8060(e,t,n){"use strict";var r=n(7133),i=n(942),s=n(5589),o=Object,a=r("".split);e.exports=i(function(){return!o("z").propertyIsEnumerable(0)})?function(e){return"String"===s(e)?a(e,""):o(e)}:o},8067(e,t,n){"use strict";var r=n(3353),i=n(848),s=n(890),o=n(492),a=n(7133),c=n(942),u=n(9323),l=n(9200),h=n(3519),d=n(460),f=n(5589),p=n(7830),m=n(2485),g=n(8733),y=n(685),v=n(260),w=n(4026),b=String,_=i("JSON","stringify"),E=a(/./.exec),I=a("".charAt),T=a("".charCodeAt),S=a("".replace),C=a("".slice),A=a([].push),k=a(1.1.toString),N=/[\uD800-\uDFFF]/g,R=/^[\uD800-\uDBFF]$/,O=/^[\uDC00-\uDFFF]$/,x=y(),P=x.length,D=!v||c(function(){var e=i("Symbol")("stringify detection");return"[null]"!==_([e])||"{}"!==_({a:e})||"{}"!==_(Object(e))}),M=c(function(){return'"\\udf06\\ud834"'!==_("\udf06\ud834")||'"\\udead"'!==_("\udead")}),L=D?function(e,t){var n=m(arguments),r=V(t);if(l(r)||void 0!==e&&!d(e))return n[1]=function(e,t){if(l(r)&&(t=o(r,this,b(e),t)),!d(t))return t},s(_,null,n)}:_,F=function(e,t,n){var r=I(n,t-1),i=I(n,t+1);return E(R,e)&&!E(O,i)||E(O,e)&&!E(R,r)?"\\u"+k(T(e,0),16):e},V=function(e){if(l(e))return e;if(u(e)){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];"string"==typeof i?A(n,i):"number"!=typeof i&&"Number"!==f(i)&&"String"!==f(i)||A(n,p(i))}var s=n.length,o=!0;return function(e,t){if(o)return o=!1,t;if(u(this))return t;for(var r=0;r<s;r++)if(n[r]===e)return t}}};_&&r({target:"JSON",stat:!0,arity:3,forced:D||M||!w},{stringify:function(e,t,n){var r=V(t),i=[],s=L(e,function(e,t){var n=l(r)?o(r,this,b(e),t):t;return!w&&h(n)?x+(A(i,n.rawJSON)-1):n},n);if("string"!=typeof s)return s;if(M&&(s=S(s,N,F)),w)return s;for(var a="",c=s.length,u=0;u<c;u++){var d=I(s,u);if('"'===d){var f=g(s,++u).end-1,p=C(s,u,f);a+=C(p,0,P)===x?i[C(p,P)]:'"'+p+'"',u=f}else a+=d}return a}})},8070(e,t,n){"use strict";var r=n(8793),i=n(3217),s=n(5827),o=n(7933),a=n(5044),c=n(1606),u=n(4702)("iterator"),l=o.values,h=function(e,t){if(e){if(e[u]!==l)try{a(e,u,l)}catch(t){e[u]=l}if(c(e,t,!0),i[t])for(var n in o)if(e[n]!==o[n])try{a(e,n,o[n])}catch(t){e[n]=o[n]}}};for(var d in i)h(r[d]&&r[d].prototype,d);h(s,"DOMTokenList")},8098(e,t,n){"use strict";n(404),n(6391),n(1497),n(8067),n(2062)},8168(e,t,n){var r=n(5132);e.exports=function(e,t,n,i,s){var o=r(e,t,n,i,s);return o.next().then(function(e){return e.done?e.value:o.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},8226(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},8456(e,t,n){"use strict";var r=n(7285),i=TypeError;e.exports=function(e){if(r(e))throw new i("The method doesn't accept regular expressions");return e}},8466(e,t,n){"use strict";var r=n(8793),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},8479(e,t,n){"use strict";var r=n(4932),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},8521(e,t,n){"use strict";var r=n(9200),i=n(4446),s=n(4174),o=n(8466);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:t;if(r(n)&&s(n,u,a),a.global)c?e[t]=n:o(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},8636(e,t,n){var r=n(6367),i=n(7986),s=n(8168),o=n(5132),a=n(7362),c=n(58),u=n(8988);function l(){"use strict";var t=i(),n=t.m(l),h=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function d(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))}var f={throw:1,return:2,break:3,continue:3};function p(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,f[e],t)},delegateYield:function(e,i,s){return t.resultName=i,n(r.d,u(e),s)},finish:function(e){return n(r.f,e)}},n=function(e,n,i){r.p=t.prev,r.n=t.next;try{return e(n,i)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=l=function(){return{wrap:function(e,n,r,i){return t.w(p(e),n,r,i&&i.reverse())},isGeneratorFunction:d,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:a,async:function(e,t,n,r,i){return(d(t)?o:s)(p(e),t,n,r,i)},keys:c,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports},8700(e,t,n){"use strict";var r=n(7403).PROPER,i=n(8521),s=n(4398),o=n(7830),a=n(942),c=n(7781),u="toString",l=RegExp.prototype,h=l[u],d=a(function(){return"/a/b"!==h.call({source:"a",flags:"b"})}),f=r&&h.name!==u;(d||f)&&i(l,u,function(){var e=s(this);return"/"+o(e.source)+"/"+o(c(e))},{unsafe:!0})},8718(e,t,n){"use strict";var r=n(9944).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},8733(e,t,n){"use strict";var r=n(7133),i=n(9158),s=SyntaxError,o=parseInt,a=String.fromCharCode,c=r("".charAt),u=r("".slice),l=r(/./.exec),h={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"},d=/^[\da-f]{4}$/i,f=/^[\u0000-\u001F]$/;e.exports=function(e,t){for(var n=!0,r="";t<e.length;){var p=c(e,t);if("\\"===p){var m=u(e,t,t+2);if(i(h,m))r+=h[m],t+=2;else{if("\\u"!==m)throw new s('Unknown escape sequence: "'+m+'"');var g=u(e,t+=2,t+4);if(!l(d,g))throw new s("Bad Unicode escape at: "+t);r+=a(o(g,16)),t+=4}}else{if('"'===p){n=!1,t++;break}if(l(f,p))throw new s("Bad control character in string literal at: "+t);r+=p,t++}}if(n)throw new s("Unterminated string at: "+t);return{value:r,end:t}}},8793(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},8959(e,t,n){"use strict";var r=n(7133),i=n(9158),s=n(4360),o=n(6134).indexOf,a=n(640),c=r([].push);e.exports=function(e,t){var n,r=s(e),u=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&c(l,n);for(;t.length>u;)i(r,n=t[u++])&&(~o(l,n)||c(l,n));return l}},8965(e,t,n){"use strict";var r=n(7133),i=n(9272),s=Math.floor,o=r("".charAt),a=r("".replace),c=r("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,h,d){var f=n+e.length,p=r.length,m=l;return void 0!==h&&(h=i(h),m=u),a(d,m,function(i,a){var u;switch(o(a,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,f);case"<":u=h[c(a,1,-1)];break;default:var l=+a;if(0===l)return i;if(l>p){var d=s(l/10);return 0===d?i:d<=p?void 0===r[d-1]?o(a,1):r[d-1]+o(a,1):i}u=r[l-1]}return void 0===u?"":u})}},8988(e,t,n){var r=n(9091).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},9091(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},9131(e,t,n){"use strict";var r=n(9200);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},9140(e,t,n){"use strict";var r,i,s=n(8793),o=n(824),a=s.process,c=s.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},9158(e,t,n){"use strict";var r=n(7133),i=n(9272),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},9200(e){"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},9229(e,t,n){"use strict";var r=n(7133),i=n(2365);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},9253(e,t,n){"use strict";var r=n(4702)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},9260(e,t,n){"use strict";var r=n(942),i=n(8793).RegExp,s=r(function(){var e=i("a","y");return e.lastIndex=2,null!==e.exec("abcd")}),o=s||r(function(){return!i("a","y").sticky}),a=s||r(function(){var e=i("^r","gy");return e.lastIndex=2,null!==e.exec("str")});e.exports={BROKEN_CARET:a,MISSED_STICKY:o,UNSUPPORTED_Y:s}},9272(e,t,n){"use strict";var r=n(3977),i=Object;e.exports=function(e){return i(r(e))}},9323(e,t,n){"use strict";var r=n(5589);e.exports=Array.isArray||function(e){return"Array"===r(e)}},9325(e,t,n){"use strict";var r=n(2365),i=n(2178);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},9400(e,t,n){"use strict";var r=n(492),i=n(4398),s=n(9325);e.exports=function(e,t,n){var o,a;i(e);try{if(!(o=s(e,"return"))){if("throw"===t)throw n;return n}o=r(o,e)}catch(e){a=!0,o=e}if("throw"===t)throw n;if(a)throw o;return i(o),n}},9422(e,t,n){"use strict";var r=n(492),i=n(9131),s=n(460),o=n(9325),a=n(1427),c=n(4702),u=TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var n,c=o(e,l);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!i(n)||s(n))return n;throw new u("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},9468(e,t,n){"use strict";var r=n(5457),i=n(492),s=n(9272),o=n(1512),a=n(6),c=n(3614),u=n(7457),l=n(5909),h=n(1778),d=n(590),f=Array;e.exports=function(e){var t=s(e),n=c(this),p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m;g&&(m=r(m,p>2?arguments[2]:void 0));var y,v,w,b,_,E,I=d(t),T=0;if(!I||this===f&&a(I))for(y=u(t),v=n?new this(y):f(y);y>T;T++)E=g?m(t[T],T):t[T],l(v,T,E);else for(v=n?new this:[],_=(b=h(t,I)).next;!(w=i(_,b)).done;T++)E=g?o(b,m,[w.value,T],!0):w.value,l(v,T,E);return v.length=T,v}},9498(e,t,n){"use strict";var r=n(6760);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},9656(e,t,n){"use strict";var r=n(7596),i=n(9158),s=n(4990),o=n(4446).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||o(t,e,{value:s.f(e)})}},9671(e,t,n){"use strict";var r=n(4702)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){try{if(!t&&!i)return!1}catch(e){return!1}var n=!1;try{var s={};s[r]=function(){return{next:function(){return{done:n=!0}}}},e(s)}catch(e){}return n}},9677(e,t,n){"use strict";var r=n(100),i=String,s=TypeError;e.exports=function(e){if(r(e))return e;throw new s("Can't set "+i(e)+" as a prototype")}},9824(e,t,n){"use strict";var r=n(4398);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},9908(e,t,n){"use strict";var r=n(3353),i=n(8793),s=n(6575)(i.setInterval,!0);r({global:!0,bind:!0,forced:i.setInterval!==s},{setInterval:s})},9944(e,t,n){"use strict";var r=n(7133),i=n(4932),s=n(7830),o=n(3977),a=r("".charAt),c=r("".charCodeAt),u=r("".slice),l=function(e){return function(t,n){var r,l,h=s(o(t)),d=i(n),f=h.length;return d<0||d>=f?e?"":void 0:(r=c(h,d))<55296||r>56319||d+1===f||(l=c(h,d+1))<56320||l>57343?e?a(h,d):r:e?u(h,d,d+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,n,r,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise(function(i,s){var o=t.apply(n,r);function a(t){e(o,i,s,a,c,"next",t)}function c(t){e(o,i,s,a,c,"throw",t)}a(void 0)})}}n(2584);var r=n(2971),i=n.n(r);const s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==c)throw new a;const u=i<<2|s>>4;if(r.push(u),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==c){const e=o<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class a extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){return function(e){const t=s(e);return o.encodeByteArray(t,!0)}(e).replace(/\./g,"")},u=function(e){try{return o.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const l=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>{var t,n;return null===(n=null===(t=l())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=()=>{var e;return null===(e=l())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=l())||void 0===t?void 0:t[`_${e}`]};class p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function m(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(e){return!1}}async function g(e){return(await fetch(e,{credentials:"include"})).ok}const y={};let v=!1;function w(e,t){if("undefined"==typeof window||"undefined"==typeof document||!m(window.location.host)||y[e]===t||y[e]||v)return;function n(e){return`__firebase__banner__${e}`}y[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(y))y[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),a=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(a,o);const n=function(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{v=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,s,a,n),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return!function(){var e;const t=null===(e=l())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class E extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,I.prototype.create)}}class I{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(T,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new E(r,o,n)}}const T=/\{\$([^}]+)}/g;function S(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(C(n)&&C(s)){if(!S(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function C(e){return null!==e&&"object"==typeof e}function A(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function k(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function N(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class R{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=O),void 0===r.error&&(r.error=O),void 0===r.complete&&(r.complete=O);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O(){}function x(e){return e&&e._delegate?e._delegate:e}class P{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const D="[DEFAULT]";class M{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new p;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:D})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=D){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=D){return this.instances.has(e)}getOptions(e=D){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===D?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=D){return this.component?this.component.multipleInstances?e:D:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class L{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new M(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const F=[];var V;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(V||(V={}));const U={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},j=V.INFO,B={[V.DEBUG]:"log",[V.VERBOSE]:"log",[V.INFO]:"info",[V.WARN]:"warn",[V.ERROR]:"error"},K=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=B[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class H{constructor(e){this.name=e,this._logLevel=j,this._logHandler=K,this._userLogHandler=null,F.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?U[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,V.DEBUG,...e),this._logHandler(this,V.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,V.VERBOSE,...e),this._logHandler(this,V.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,V.INFO,...e),this._logHandler(this,V.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,V.WARN,...e),this._logHandler(this,V.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,V.ERROR,...e),this._logHandler(this,V.ERROR,...e)}}let $,z;const q=new WeakMap,G=new WeakMap,W=new WeakMap,Y=new WeakMap,Q=new WeakMap;let J={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return G.get(e);if("objectStoreNames"===t)return e.objectStoreNames||W.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Z(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function X(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(z||(z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ee(this),e),Z(q.get(this))}:function(...e){return Z(t.apply(ee(this),e))}:function(e,...n){const r=t.call(ee(this),e,...n);return W.set(r,e.sort?e.sort():[e]),Z(r)}:(e instanceof IDBTransaction&&function(e){if(G.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});G.set(e,t)}(e),n=e,($||($=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>n instanceof e)?new Proxy(e,J):e);var t,n}function Z(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Z(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&q.set(t,e)}).catch(()=>{}),Q.set(t,e),t}(e);if(Y.has(e))return Y.get(e);const t=X(e);return t!==e&&(Y.set(e,t),Q.set(t,e)),t}const ee=e=>Q.get(e),te=["get","getKey","getAll","getAllKeys","count"],ne=["put","add","delete","clear"],re=new Map;function ie(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(re.get(t))return re.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ne.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!te.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return re.set(t,s),s}var se;se=J,J={...se,get:(e,t,n)=>ie(e,t)||se.get(e,t,n),has:(e,t)=>!!ie(e,t)||se.has(e,t)};class oe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const ae="@firebase/app",ce="0.13.2",ue=new H("@firebase/app"),le="@firebase/app-compat",he="@firebase/analytics-compat",de="@firebase/analytics",fe="@firebase/app-check-compat",pe="@firebase/app-check",me="@firebase/auth",ge="@firebase/auth-compat",ye="@firebase/database",ve="@firebase/data-connect",we="@firebase/database-compat",be="@firebase/functions",_e="@firebase/functions-compat",Ee="@firebase/installations",Ie="@firebase/installations-compat",Te="@firebase/messaging",Se="@firebase/messaging-compat",Ce="@firebase/performance",Ae="@firebase/performance-compat",ke="@firebase/remote-config",Ne="@firebase/remote-config-compat",Re="@firebase/storage",Oe="@firebase/storage-compat",xe="@firebase/firestore",Pe="@firebase/ai",De="@firebase/firestore-compat",Me="firebase",Le="[DEFAULT]",Fe={[ae]:"fire-core",[le]:"fire-core-compat",[de]:"fire-analytics",[he]:"fire-analytics-compat",[pe]:"fire-app-check",[fe]:"fire-app-check-compat",[me]:"fire-auth",[ge]:"fire-auth-compat",[ye]:"fire-rtdb",[ve]:"fire-data-connect",[we]:"fire-rtdb-compat",[be]:"fire-fn",[_e]:"fire-fn-compat",[Ee]:"fire-iid",[Ie]:"fire-iid-compat",[Te]:"fire-fcm",[Se]:"fire-fcm-compat",[Ce]:"fire-perf",[Ae]:"fire-perf-compat",[ke]:"fire-rc",[Ne]:"fire-rc-compat",[Re]:"fire-gcs",[Oe]:"fire-gcs-compat",[xe]:"fire-fst",[De]:"fire-fst-compat",[Pe]:"fire-vertex","fire-js":"fire-js",[Me]:"fire-js-all"},Ve=new Map,Ue=new Map,je=new Map;function Be(e,t){try{e.container.addComponent(t)}catch(n){ue.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ke(e){const t=e.name;if(je.has(t))return ue.debug(`There were multiple attempts to register component ${t}.`),!1;je.set(t,e);for(const t of Ve.values())Be(t,e);for(const t of Ue.values())Be(t,e);return!0}function He(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function $e(e){return null!=e&&void 0!==e.settings}const ze=new I("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class qe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new P("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ze.create("app-deleted",{appName:this._name})}}const Ge="11.10.0";function We(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:Le,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!=typeof i||!i)throw ze.create("bad-app-name",{appName:String(i)});if(n||(n=d()),!n)throw ze.create("no-options");const s=Ve.get(i);if(s){if(S(n,s.options)&&S(r,s.config))return s;throw ze.create("duplicate-app",{appName:i})}const o=new L(i);for(const e of je.values())o.addComponent(e);const a=new qe(n,r,o);return Ve.set(i,a),a}function Ye(e=Le){const t=Ve.get(e);if(!t&&e===Le&&d())return We();if(!t)throw ze.create("no-app",{appName:e});return t}function Qe(e,t,n){var r;let i=null!==(r=Fe[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ue.warn(e.join(" "))}Ke(new P(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const Je="firebase-heartbeat-store";let Xe=null;function Ze(){return Xe||(Xe=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=Z(o);return r&&o.addEventListener("upgradeneeded",e=>{r(Z(o.result),e.oldVersion,e.newVersion,Z(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Je)}catch(e){console.warn(e)}}}).catch(e=>{throw ze.create("idb-open",{originalErrorMessage:e.message})})),Xe}async function et(e,t){try{const n=(await Ze()).transaction(Je,"readwrite"),r=n.objectStore(Je);await r.put(t,tt(e)),await n.done}catch(e){if(e instanceof E)ue.warn(e.message);else{const t=ze.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}function tt(e){return`${e.name}!${e.options.appId}`}class nt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new it(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=rt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ue.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=rt(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),st(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),st(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=c(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ue.warn(e),""}}}function rt(){return(new Date).toISOString().substring(0,10)}class it{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Ze()).transaction(Je),n=await t.objectStore(Je).get(tt(e));return await t.done,n}catch(e){if(e instanceof E)ue.warn(e.message);else{const t=ze.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return et(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return et(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function st(e){return c(JSON.stringify({version:2,heartbeats:e})).length}function ot(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Ke(new P("platform-logger",e=>new oe(e),"PRIVATE")),Ke(new P("heartbeat",e=>new nt(e),"PRIVATE")),Qe(ae,ce,""),Qe(ae,ce,"esm2017"),Qe("fire-js",""),Qe("firebase","11.10.0","app"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const at=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ct=new I("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ut=new H("@firebase/auth");function lt(e,...t){ut.logLevel<=V.ERROR&&ut.error(`Auth (${Ge}): ${e}`,...t)}function ht(e,...t){throw mt(e,...t)}function dt(e,...t){return mt(e,...t)}function ft(e,t,n){const r=Object.assign(Object.assign({},at()),{[t]:n});return new I("auth","Firebase",r).create(t,{appName:e.name})}function pt(e){return ft(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mt(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return ct.create(e,...t)}function gt(e,t,...n){if(!e)throw mt(t,...n)}function yt(e){const t="INTERNAL ASSERTION FAILED: "+e;throw lt(t),new Error(t)}function vt(e,t){e||yt(t)}function wt(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function bt(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function _t(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===bt()||"https:"===bt()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Et{constructor(e,t){this.shortDelay=e,this.longDelay=t,vt(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return _t()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function It(e,t){vt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Tt{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void yt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void yt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void yt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const St={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ct=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],At=new Et(3e4,6e4);function kt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Nt(e,t,n,r,i={}){return Rt(e,i,async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=A(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:a},i);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),e.emulatorConfig&&m(e.emulatorConfig.host)&&(c.credentials="include"),Tt.fetch()(await xt(e,e.config.apiHost,n,o),c)})}async function Rt(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},St),t);try{const t=new Dt(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Mt(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Mt(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Mt(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Mt(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw ft(e,a,o);ht(e,a)}}catch(t){if(t instanceof E)throw t;ht(e,"network-request-failed",{message:String(t)})}}async function Ot(e,t,n,r,i={}){const s=await Nt(e,t,n,r,i);return"mfaPendingCredential"in s&&ht(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function xt(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?It(e.config,i):`${e.config.apiScheme}://${i}`;return Ct.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())?s._getPersistence()._getFinalTarget(o).toString():o}function Pt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Dt{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(dt(this.auth,"network-request-failed")),At.get())})}}function Mt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=dt(e,t,r);return i.customData._tokenResponse=n,i}function Lt(e){return void 0!==e&&void 0!==e.enterprise}class Ft{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Pt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Vt(e,t){return Nt(e,"GET","/v2/recaptchaConfig",kt(e,t))}async function Ut(e,t){return Nt(e,"POST","/v1/accounts:lookup",t)}function jt(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Bt(e){return 1e3*Number(e)}function Kt(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return lt("JWT malformed, contained fewer than 3 sections"),null;try{const e=u(n);return e?JSON.parse(e):(lt("Failed to decode base64 JWT payload"),null)}catch(e){return lt("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function Ht(e){const t=Kt(e);return gt(t,"internal-error"),gt(void 0!==t.exp,"internal-error"),gt(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function $t(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof E&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class zt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class qt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jt(this.lastLoginAt),this.creationTime=jt(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Gt(e){var t;const n=e.auth,r=await e.getIdToken(),i=await $t(e,Ut(n,{idToken:r}));gt(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Wt(s.providerUserInfo):[],a=(c=e.providerData,u=o,[...c.filter(e=>!u.some(t=>t.providerId===e.providerId)),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new qt(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function Wt(e){return e.map(e=>{var{providerId:t}=e,n=ot(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Yt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){gt(e.idToken,"internal-error"),gt(void 0!==e.idToken,"internal-error"),gt(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Ht(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){gt(0!==e.length,"internal-error");const t=Ht(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Rt(e,{},async()=>{const n=A({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await xt(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&m(e.emulatorConfig.host)&&(a.credentials="include"),Tt.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Yt;return n&&(gt("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(gt("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(gt("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yt,this.toJSON())}_performRefresh(){return yt("not implemented")}}function Qt(e,t){gt("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Jt{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=ot(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new qt(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await $t(this,this.stsTokenManager.getToken(this.auth,e));return gt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=x(e),r=await n.getIdToken(t),i=Kt(r);gt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:jt(Bt(i.auth_time)),issuedAtTime:jt(Bt(i.iat)),expirationTime:jt(Bt(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=x(e);await Gt(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Jt(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Gt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($e(this.auth.app))return Promise.reject(pt(this.auth));const e=await this.getIdToken();return await $t(this,async function(e,t){return Nt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=t;gt(v&&E,e,"internal-error");const I=Yt.fromJSON(this.name,E);gt("string"==typeof v,e,"internal-error"),Qt(l,e.name),Qt(h,e.name),gt("boolean"==typeof w,e,"internal-error"),gt("boolean"==typeof b,e,"internal-error"),Qt(d,e.name),Qt(f,e.name),Qt(p,e.name),Qt(m,e.name),Qt(g,e.name),Qt(y,e.name);const T=new Jt({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return _&&Array.isArray(_)&&(T.providerData=_.map(e=>Object.assign({},e))),m&&(T._redirectEventId=m),T}static async _fromIdTokenResponse(e,t,n=!1){const r=new Yt;r.updateFromServerResponse(t);const i=new Jt({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Gt(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];gt(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Wt(r.providerUserInfo):[],s=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),o=new Yt;o.updateFromIdToken(n);const a=new Jt({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new qt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,c),a}}const Xt=new Map;function Zt(e){vt(e instanceof Function,"Expected a class definition");let t=Xt.get(e);return t?(vt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Xt.set(e,t),t)}class en{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}en.type="NONE";const tn=en;function nn(e,t,n){return`firebase:${e}:${t}:${n}`}class rn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=nn(this.userKey,r.apiKey,i),this.fullPersistenceKey=nn("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await Ut(this.auth,{idToken:e}).catch(()=>{});return t?Jt._fromGetAccountInfoResponse(this.auth,t,e):null}return Jt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new rn(Zt(tn),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Zt(tn);const s=nn(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){let r;if("string"==typeof t){const n=await Ut(e,{idToken:t}).catch(()=>{});if(!n)break;r=await Jt._fromGetAccountInfoResponse(e,n,t)}else r=Jt._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(e){}})),new rn(i,e,n)):new rn(i,e,n)}}function sn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(un(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(on(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(hn(t))return"Blackberry";if(dn(t))return"Webos";if(an(t))return"Safari";if((t.includes("chrome/")||cn(t))&&!t.includes("edge/"))return"Chrome";if(ln(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function on(e=b()){return/firefox\//i.test(e)}function an(e=b()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function cn(e=b()){return/crios\//i.test(e)}function un(e=b()){return/iemobile/i.test(e)}function ln(e=b()){return/android/i.test(e)}function hn(e=b()){return/blackberry/i.test(e)}function dn(e=b()){return/webos/i.test(e)}function fn(e=b()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function pn(e=b()){return fn(e)||ln(e)||dn(e)||hn(e)||/windows phone/i.test(e)||un(e)}function mn(e,t=[]){let n;switch(e){case"Browser":n=sn(b());break;case"Worker":n=`${sn(b())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ge}/${r}`}class gn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class yn{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class vn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bn(this),this.idTokenSubscription=new bn(this),this.beforeStateQueue=new gn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ct,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zt(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await rn.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Ut(this,{idToken:e}),n=await Jt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if($e(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gt(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($e(this.app))return Promise.reject(pt(this));const t=e?x(e):null;return t&&gt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $e(this.app)?Promise.reject(pt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $e(this.app)?Promise.reject(pt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zt(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Nt(e,"GET","/v2/passwordPolicy",kt(e,t))}(this),t=new yn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new I("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Nt(e,"POST","/v2/accounts:revokeToken",kt(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zt(e)||this._popupRedirectResolver;gt(t,this,"argument-error"),this.redirectPersistenceManager=await rn.create(this,[Zt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if($e(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){ut.logLevel<=V.WARN&&ut.warn(`Auth (${Ge}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function wn(e){return x(e)}class bn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e){const t=new R(e,void 0);return t.subscribe.bind(t)}(e=>this.observer=e)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _n={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function En(e){return _n.loadJS(e)}function In(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Tn{constructor(){this.enterprise=new Sn}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Sn{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Cn="NO_RECAPTCHA";class An{constructor(e){this.type="recaptcha-enterprise",this.auth=wn(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;Lt(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Cn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new Tn).execute("siteKey",{action:"verify"}):new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Vt(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Ft(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Lt(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=_n.recaptchaEnterpriseScript;0!==t.length&&(t+=i),En(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function kn(e,t,n,r=!1,i=!1){const s=new An(e);let o;if(i)o=Cn;else try{o=await s.verify(n)}catch(e){o=await s.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Nn(e,t,n,r,i){var s,o;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await kn(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await kn(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const i=await kn(e,t,n);return r(e,i).catch(async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await kn(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await kn(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}function Rn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function On(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return yt("not implemented")}_getIdTokenResponse(e){return yt("not implemented")}_linkToIdToken(e,t){return yt("not implemented")}_getReauthenticationResolver(e){return yt("not implemented")}}async function Pn(e,t){return Nt(e,"POST","/v1/accounts:signUp",t)}async function Dn(e,t){return Ot(e,"POST","/v1/accounts:signInWithPassword",kt(e,t))}class Mn extends xn{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Mn(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Mn(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Nn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Dn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ot(e,"POST","/v1/accounts:signInWithEmailLink",kt(e,t))}(e,{email:this._email,oobCode:this._password});default:ht(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Nn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Pn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ot(e,"POST","/v1/accounts:signInWithEmailLink",kt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:ht(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ln(e,t){return Ot(e,"POST","/v1/accounts:signInWithIdp",kt(e,t))}class Fn extends xn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ht("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=ot(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Fn(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ln(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ln(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ln(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=A(t)}return e}}async function Vn(e,t){return Nt(e,"POST","/v1/accounts:sendVerificationCode",kt(e,t))}const Un={USER_NOT_FOUND:"user-not-found"};class jn extends xn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new jn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new jn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ot(e,"POST","/v1/accounts:signInWithPhoneNumber",kt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ot(e,"POST","/v1/accounts:signInWithPhoneNumber",kt(e,t));if(n.temporaryProof)throw Mt(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Ot(e,"POST","/v1/accounts:signInWithPhoneNumber",kt(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Un)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new jn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Bn{constructor(e){var t,n,r,i,s,o;const a=k(N(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);gt(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=k(N(e)).link,n=t?k(N(t)).deep_link_id:null,r=k(N(e)).deep_link_id;return(r?k(N(r)).link:null)||r||n||t||e}(e);try{return new Bn(t)}catch(e){return null}}}class Kn{constructor(){this.providerId=Kn.PROVIDER_ID}static credential(e,t){return Mn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Bn.parseLink(t);return gt(n,"argument-error"),Mn._fromEmailAndCode(e,n.code,n.tenantId)}}Kn.PROVIDER_ID="password",Kn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Kn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Hn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $n extends Hn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zn extends $n{constructor(){super("facebook.com")}static credential(e){return Fn._fromParams({providerId:zn.PROVIDER_ID,signInMethod:zn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zn.credentialFromTaggedObject(e)}static credentialFromError(e){return zn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return zn.credential(e.oauthAccessToken)}catch(e){return null}}}zn.FACEBOOK_SIGN_IN_METHOD="facebook.com",zn.PROVIDER_ID="facebook.com";class qn extends $n{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fn._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return qn.credential(t,n)}catch(e){return null}}}qn.GOOGLE_SIGN_IN_METHOD="google.com",qn.PROVIDER_ID="google.com";class Gn extends $n{constructor(){super("github.com")}static credential(e){return Fn._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Gn.credential(e.oauthAccessToken)}catch(e){return null}}}Gn.GITHUB_SIGN_IN_METHOD="github.com",Gn.PROVIDER_ID="github.com";class Wn extends $n{constructor(){super("twitter.com")}static credential(e,t){return Fn._fromParams({providerId:Wn.PROVIDER_ID,signInMethod:Wn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wn.credentialFromTaggedObject(e)}static credentialFromError(e){return Wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Wn.credential(t,n)}catch(e){return null}}}Wn.TWITTER_SIGN_IN_METHOD="twitter.com",Wn.PROVIDER_ID="twitter.com";class Yn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Jt._fromIdTokenResponse(e,n,r),s=Qn(n);return new Yn({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Qn(n);return new Yn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Qn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Jn extends E{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Jn.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Jn(e,t,n,r)}}function Xn(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Jn._fromErrorAndOperation(e,n,t,r);throw n})}function Zn(e){return x(e).signOut()}function er(e,t){return Nt(e,"POST","/v2/accounts/mfaEnrollment:start",kt(e,t))}new WeakMap;const tr="__sak";class nr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(tr,"1"),this.storage.removeItem(tr),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class rr extends nr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=b();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rr.type="LOCAL";const ir=rr;class sr extends nr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sr.type="SESSION";const or=sr;class ar{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new ar(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function cr(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ar.receivers=[];class ur{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const c=cr("",20);r.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function lr(){return window}function hr(){return void 0!==lr().WorkerGlobalScope&&"function"==typeof lr().importScripts}const dr="firebaseLocalStorageDb",fr="firebaseLocalStorage",pr="fbase_key";class mr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function gr(e,t){return e.transaction([fr],t?"readwrite":"readonly").objectStore(fr)}function yr(){const e=indexedDB.open(dr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(fr,{keyPath:pr})}catch(e){n(e)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(fr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(dr);return new mr(e).toPromise()}(),t(await yr()))})})}async function vr(e,t,n){const r=gr(e,!0).put({[pr]:t,value:n});return new mr(r).toPromise()}function wr(e,t){const n=gr(e,!0).delete(t);return new mr(n).toPromise()}class br{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await yr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ar._getInstance(hr()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new ur(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yr();return await vr(e,tr,"1"),await wr(e,tr),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>vr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=gr(e,!1).get(t),r=await new mr(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>wr(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=gr(e,!1).getAll();return new mr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}br.type="LOCAL";const _r=br;function Er(e,t){return Nt(e,"POST","/v2/accounts/mfaSignIn:start",kt(e,t))}In("rcb"),new Et(3e4,6e4);const Ir="recaptcha";async function Tr(e,t,n){var r;if(!e._getRecaptchaConfig())try{await async function(e){const t=wn(e),n=await Vt(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Ft(n);null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new An(t).verify()}(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"==typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){gt("enroll"===t.type,e,"internal-error");const r=Nn(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},"mfaSmsEnrollment",async(e,t)=>t.phoneEnrollmentInfo.captchaResponse===Cn?(gt((null==n?void 0:n.type)===Ir,e,"argument-error"),er(e,await Sr(e,t,n))):er(e,t),"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{gt("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;gt(s,e,"missing-multi-factor-info");const o=Nn(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},"mfaSmsSignIn",async(e,t)=>t.phoneSignInInfo.captchaResponse===Cn?(gt((null==n?void 0:n.type)===Ir,e,"argument-error"),Er(e,await Sr(e,t,n))):Er(e,t),"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t=Nn(e,{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},"sendVerificationCode",async(e,t)=>t.captchaResponse===Cn?(gt((null==n?void 0:n.type)===Ir,e,"argument-error"),Vn(e,await Sr(e,t,n))):Vn(e,t),"PHONE_PROVIDER");return(await t.catch(e=>Promise.reject(e))).sessionInfo}}finally{null==n||n._reset()}}async function Sr(e,t,n){gt(n.type===Ir,e,"argument-error");const r=await n.verify();gt("string"==typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Cr{constructor(e){this.providerId=Cr.PROVIDER_ID,this.auth=wn(e)}verifyPhoneNumber(e,t){return Tr(this.auth,e,x(t))}static credential(e,t){return jn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Cr.credentialFromTaggedObject(t)}static credentialFromError(e){return Cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?jn._fromTokenResponse(t,n):null}}Cr.PROVIDER_ID="phone",Cr.PHONE_SIGN_IN_METHOD="phone";class Ar extends xn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ln(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ln(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ln(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kr(e){return async function(e,t,n=!1){if($e(e.app))return Promise.reject(pt(e));const r="signIn",i=await Xn(e,r,t),s=await Yn._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Ar(e),e.bypassAuthState)}function Nr(e){const{auth:t,user:n}=e;return gt(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if($e(r.app))return Promise.reject(pt(r));const i="reauthenticate";try{const s=await $t(e,Xn(r,i,t,e),n);gt(s.idToken,r,"internal-error");const o=Kt(s.idToken);gt(o,r,"internal-error");const{sub:a}=o;return gt(e.uid===a,r,"user-mismatch"),Yn._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&ht(r,"user-mismatch"),e}}(n,new Ar(e),e.bypassAuthState)}async function Rr(e){const{auth:t,user:n}=e;return gt(n,t,"internal-error"),async function(e,t,n=!1){const r=await $t(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Yn._forOperation(e,"link",r)}(n,new Ar(e),e.bypassAuthState)}class Or{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kr;case"linkViaPopup":case"linkViaRedirect":return Rr;case"reauthViaPopup":case"reauthViaRedirect":return Nr;default:ht(this.auth,"internal-error")}}resolve(e){vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const xr=new Et(2e3,1e4);class Pr extends Or{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Pr.currentPopupAction&&Pr.currentPopupAction.cancel(),Pr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return gt(e,this.auth,"internal-error"),e}async onExecution(){vt(1===this.filter.length,"Popup operations only handle one event");const e=cr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(dt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dt(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,xr.get())};e()}}Pr.currentPopupAction=null;const Dr=new Map;class Mr extends Or{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Dr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return nn("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return Zt(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Dr.set(this.auth._key(),e)}return this.bypassAuthState||Dr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Lr(e,t){Dr.set(e._key(),t)}async function Fr(e,t,n=!1){if($e(e.app))return Promise.reject(pt(e));const r=wn(e),i=function(e,t){return t?Zt(t):(gt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new Mr(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Vr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!jr(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(dt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ur(e))}saveEventToCache(e){this.cachedEventUids.add(Ur(e)),this.lastProcessedEventTime=Date.now()}}function Ur(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function jr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Br=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kr=/^https?/;function Hr(e){const t=wt(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Kr.test(n))return!1;if(Br.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const $r=new Et(3e4,6e4);function zr(){const e=lr().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function qr(e){return new Promise((t,n)=>{var r,i,s;function o(){zr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{zr(),n(dt(e,"network-request-failed"))},timeout:$r.get()})}if(null===(i=null===(r=lr().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=lr().gapi)||void 0===s?void 0:s.load)){const t=In("iframefcb");return lr()[t]=()=>{gapi.load?o():n(dt(e,"network-request-failed"))},En(`${_n.gapiScript}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw Gr=null,e})}let Gr=null;const Wr=new Et(5e3,15e3),Yr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Qr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Jr(e){const t=e.config;gt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?It(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ge},i=Qr.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${A(r).slice(1)}`}const Xr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Zr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const ei=encodeURIComponent("fac");async function ti(e,t,n,r,i,s){gt(e.config.authDomain,e,"auth-domain-config-required"),gt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ge,eventId:i};if(t instanceof Hn){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof $n){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${ei}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?It(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${A(a).slice(1)}${u}`}const ni="webStorageSupport",ri=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=or,this._completeRedirectFn=Fr,this._overrideRedirectResult=Lr}async _openPopup(e,t,n,r){var i;return vt(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Xr),{width:r.toString(),height:i.toString(),top:s,left:o}),u=b().toLowerCase();n&&(a=cn(u)?"_blank":n),on(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=b()){var t;return fn(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Zr(null);const h=window.open(t||"",a,l);gt(h,e,"popup-blocked");try{h.focus()}catch(e){}return new Zr(h)}(e,await ti(e,t,n,wt(),r),cr())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await ti(e,t,n,wt(),r),lr().location.href=i,new Promise(()=>{});var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(vt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return Gr=Gr||qr(e),Gr}(e),n=lr().gapi;return gt(n,e,"internal-error"),t.open({where:document.body,url:Jr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Yr,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=dt(e,"network-request-failed"),s=lr().setTimeout(()=>{r(i)},Wr.get());function o(){lr().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}(e),n=new Vr(e);return t.register("authEvent",t=>(gt(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ni,{type:ni},n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[ni];void 0!==i&&t(!!i),ht(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Nt(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Hr(e))return}catch(e){}ht(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pn()||an()||fn()}};var ii="@firebase/auth",si="1.10.8";class oi{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ai=f("authIdTokenMaxAge")||300;let ci=null;var ui;_n={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=dt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ui="Browser",Ke(new P("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;gt(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:ui,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mn(ui)},c=new vn(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Zt);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ke(new P("auth-internal",e=>(e=>new oi(e))(wn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Qe(ii,si,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(ui)),Qe(ii,si,"esm2017");var li,hi,di="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},fi={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e){var t=i;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=function(e){return new r([0|e],0>e?-1:0)}(e)}(e):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),c=s(1),u=s(16777216);function l(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(c)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(l(t))throw Error("division by zero");if(l(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!l(r);){var u=s.add(r);0>=u.l(e)&&(i=i.add(n),s=u),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),u=(s=o(n)).j(t);h(u)||0<u.l(e);)u=(s=o(n-=r)).j(t);l(s)&&(s=c),i=i.add(s),e=f(e,u)}return new m(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(l(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(l(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:l(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(l(this)||l(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(u)&&0>e.l(u))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var c=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=c*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=c*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,hi=fi.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),u=parseInt(t.substring(s,s+c),n);8>c?(c=o(Math.pow(n,c)),i=i.j(c).add(o(u))):i=(i=i.j(r)).add(o(u))}return i},li=fi.Integer=r}).apply(void 0!==di?di:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var pi,mi,gi,yi,vi,wi,bi,_i,Ei="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Ii={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ei&&Ei];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(0,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function u(e,t,n){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:c).apply(null,arguments)}function l(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(s(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=!(-1==m().indexOf("Gecko")||-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge")||-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE")||-1!=m().indexOf("Edge"));function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function I(e){i.setTimeout(()=>{throw e},0)}function T(){var e=N;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new C,e=>e.reset());class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let A,k=!1,N=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},R=()=>{const e=i.Promise.resolve(void 0);A=()=>{e.then(O)}};var O=()=>{for(var e;e=T();){try{e.h.call(e.g)}catch(e){I(e)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}k=!1};function x(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}x.prototype.s=!1,x.prototype.ma=function(){this.s||(this.s=!0,this.N())},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(e){}return e}();function M(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&M.aa.h.call(this)}}h(M,P);var L={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),V=0;function U(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++V,this.da=this.fa=!1}function j(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function K(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(j(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function H(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}B.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=H(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new U(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var $="closure_lm_"+(1e6*Math.random()|0),z={};function q(e,t,n,r,i){if(r&&r.once)return W(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)q(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.K(t,n,o(r)?!!r.capture:!!r,i):G(e,t,n,!1,r,i)}function G(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,c=Z(e);if(c||(e[$]=c=new B(e)),(n=c.add(t,n,r,a,s)).proxy)return n;if(r=function(){const e=X;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)D||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function W(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.L(t,n,o(r)?!!r.capture:!!r,i):G(e,t,n,!0,r,i)}function Y(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Y(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=H(s=e.g[t],n,r,i))&&(j(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=H(t,n,r,i)),(n=-1<e?t[e]:null)&&Q(n))}function Q(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])K(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(K(n,e),0==n.h&&(n.src=null,t[$]=null)):j(e)}}}function J(e){return e in z?z[e]:z[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new M(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Q(e),e=n.call(r,t)}return e}function Z(e){return(e=e[$])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"==typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){x.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var i=t;_(t=new P(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.fa&&K(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"==typeof e)n&&(e=u(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=u(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,oe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,x),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Y(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)j(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends x{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ce(e){x.call(this),this.h=e,this.g={}}h(ce,x);var ue=[];function le(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&Q(e)},e),e.g={}}ce.prototype.N=function(){ce.aa.N.call(this),le(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){P.call(this,"d")}function we(){P.call(this,"c")}h(ve,P),h(we,P);var be={},_e=null;function Ee(){return _e=_e||new ne}function Ie(e){P.call(this,be.La,e)}function Te(e){const t=Ee();re(t,new Ie(t))}function Se(e,t){P.call(this,be.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Ee();re(t,new Se(t,e))}function Ae(e,t){P.call(this,be.Ma,e),this.size=t}function ke(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Ne(){this.g=!0}function Re(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return he(n)}catch(e){return t}}(e,n)+(r?" "+r:"")})}be.La="serverreachability",h(Ie,P),be.STAT_EVENT="statevent",h(Se,P),be.Ma="timingevent",h(Ae,P),Ne.prototype.xa=function(){this.g=!1},Ne.prototype.info=function(){};var Oe,xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function De(){}function Me(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new ce(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}h(De,pe),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},Oe=new De;var Fe={},Ve={};function Ue(e,t,n){e.L=1,e.v=ht(ot(t)),e.m=n,e.P=!0,je(e,null)}function je(e,t){e.F=Date.now(),He(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),St(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(u(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ue[0]=i.toString()),i=ue);for(var s=0;s<i.length;s++){var o=q(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Te(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function Ke(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ve:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?Ve:(t=t.slice(r,r+n),e.C=r+n,t))}function He(e){e.S=Date.now()+e.I,$e(e,e.I)}function $e(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ke(u(e.ba,e),t)}function ze(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||cn(e.j,e)}function Ge(e){ze(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,le(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function We(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Qt(n)}rn(n),Ce(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=ke(u(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(e){}n.ca=void 0}}else ln(n,11)}else if((e.K||n.g==e)&&an(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];const t=u[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=u[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,lt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,c=r.L;c&&(a.I=c),a.B&&(ze(a),He(a)),r.g=o}else nn(r);0<n.i.length&&Xt(n)}else"stop"!=u[0]&&"close"!=u[0]||ln(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?ln(n,7):Yt(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}Te()}catch(e){}}Me.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==zt(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const d=zt(this.g);var t=this.g.Ba();if(this.g.Z(),!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||qt(this.g)))){this.J||4!=d||7==t||Te(),ze(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=qt(this.g);e="";var s=r.length,o=4==zt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ge(this),qe(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(c)){var l=c;break t}}l=null}if(!(n=l)){this.o=!1,this.s=3,Ce(12),Ge(this),qe(this);break e}Re(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,We(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Ke(this,a),e==Ve){4==d&&(this.s=4,Ce(14),n=!1),Re(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,Ce(15),Re(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Re(this.i,this.l,e,null),We(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(h),h.M=!0,Ce(11))}}else Re(this.i,this.l,a,"[Invalid Chunked Response]"),Ge(this),qe(this)}else Re(this.i,this.l,a,null),We(this,a);4==d&&Ge(this),this.o&&!this.J&&(4==d?cn(this.j,this):(this.o=!1,He(this)))}else(function(e){const t={};e=(e.g&&2<=zt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=E(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ge(this),qe(this)}}}catch(e){}},Me.prototype.cancel=function(){this.J=!0,Ge(this)},Me.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Te(),Ce(17)),Ge(this),this.s=2,qe(this)):$e(this,this.S-e)};var Ye=class{constructor(e,t){this.g=e,this.map=t}};function Qe(e){this.l=e||10,e=i.PerformanceNavigationTiming?0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(s(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Qe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,ct(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ut(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),ct(this,t[4]),this.l=dt(t[5]||"",!0),ut(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ct(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ut(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(Et(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(It(this,t),St(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,wt)),e.i=new _t(t,e.h))}function lt(e,t,n){e.i.set(t,n)}function ht(e){return lt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,bt)),e.join("")};var mt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,wt=/[#\?@]/g,bt=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Et(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function It(e,t){Et(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Tt(e,t){return Et(e),t=Ct(e,t),e.g.has(t)}function St(e,t,n){It(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),d(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function At(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(e){}}function kt(){this.g=new fe}function Nt(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;o(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Rt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ot(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function xt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Pt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Dt(e)}function Dt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Mt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Mt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):lt(e,t,n))}function Ft(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){Et(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Et(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Et(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Et(this);let t=[];if("string"==typeof e)Tt(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Et(this),this.i=null,Tt(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},h(Rt,pe),Rt.prototype.g=function(){return new Ot(this.l,this.j)},Rt.prototype.i=(mt={},function(){return mt}),h(Ot,ne),(e=Ot.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Dt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pt(this):Dt(this),3==this.readyState&&xt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Pt(this))},e.Qa=function(e){this.g&&(this.response=e,Pt(this))},e.ga=function(){this.g&&Pt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ot.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Ft,ne);var Vt=/^https?$/i,Ut=["POST","PUT"];function jt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Bt(e),Ht(e)}function Bt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Kt(e){if(e.h&&void 0!==r&&(!e.v[1]||4!=zt(e)||2!=e.Z()))if(e.u&&4==zt(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==zt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Vt.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<zt(e)?e.g.statusText:""}catch(e){a=""}e.l=a+" ["+e.Z()+"]",Bt(e)}}finally{Ht(e)}}}function Ht(e,t){if(e.g){$t(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function $t(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function zt(e){return e.g?e.g.readyState:0}function qt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Wt(e){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Qe(e&&e.concurrentRequestLimit),this.Da=new kt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Yt(e){if(Jt(e),3==e.G){var t=e.U++,n=ot(e.I);if(lt(n,"SID",e.K),lt(n,"RID",t),lt(n,"TYPE","terminate"),en(e,n),(t=new Me(e,e.j,t)).L=2,t.v=ht(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),He(t)}hn(e)}function Qt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Jt(e){Qt(e),e.u&&(i.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"==typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;A||R(),k||(A(),k=!0),N.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);lt(r,"SID",e.K),lt(r,"RID",n),lt(r,"AID",e.T),en(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Me(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&v(e.H,function(e,n){lt(t,n,e)}),e.l&&rt({},function(e,n){lt(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?u(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Nt(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;A||R(),k||(A(),k=!0),N.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v||(e.Y++,e.u=ke(u(e.Fa,e),un(e,e.v)),e.v++,0))}function sn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function on(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);lt(t,"RID","rpc"),lt(t,"SID",e.K),lt(t,"AID",e.T),lt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&lt(t,"TO",e.ja),lt(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(ot(t)),n.m=null,n.P=!0,je(n,e)}function an(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function cn(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ee(),new Ae(r,n)),Xt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=ke(u(e.Ga,e,t),un(e,e.B)),e.B++,0)))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:ln(e,5);break;case 4:ln(e,10);break;case 3:ln(e,6);break;default:ln(e,2)}}function un(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function ln(e,t){if(e.j.info("Error code "+t),2==t){var n=u(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),ht(r),t?function(e,t){const n=new Ne;if(i.Image){const r=new Image;r.onload=l(At,n,"TestLoadImage: loaded",!0,t,r),r.onerror=l(At,n,"TestLoadImage: error",!1,t,r),r.onabort=l(At,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=l(At,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ne;const n=new AbortController,r=setTimeout(()=>{n.abort(),At(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?At(0,0,!0,t):At(0,0,!1,t)}).catch(()=>{clearTimeout(r),At(0,0,!1,t)})}(r.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),ct(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&ct(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&lt(r,n,t),lt(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ft(new Rt({eb:n})):new Ft(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Wt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new wn(this)}function yn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){we.call(this),this.status=1}function wn(e){this.g=e}(e=Ft.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Oe.g(),this.v=this.o?me(this.o):me(Oe),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void jt(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$t(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){jt(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Ht(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Ft.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Kt(this):this.bb())},e.bb=function(){Kt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<zt(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Wt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ce(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Me(this,this.j,e);let s=this.o;if(this.S&&(s?(s=w(s),_(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),lt(n=ot(this.I),"RID",e),lt(n,"CVER",22),this.D&&lt(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Mt(s)))+"&"+t:this.m&&Lt(n,this.m,s)),et(this.h,i),this.Ua&&lt(n,"TYPE","init"),this.P?(lt(n,"$req",t),lt(n,"SID","null"),i.T=!0,Ue(i,n,null)):Ue(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ke(u(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Qt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Qt(this),rn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Yt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Ye(t.Ya++,e)),3==t.G&&Xt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Yt(this.g),delete this.g,gn.aa.N.call(this)},h(yn,ve),h(vn,we),h(wn,pn),wn.prototype.ua=function(){re(this.g,"a")},wn.prototype.ta=function(e){re(this.g,new yn(e))},wn.prototype.sa=function(e){re(this.g,new vn)},wn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,_i=Ii.createWebChannelTransport=function(){return new mn},bi=Ii.getStatEventTarget=function(){return Ee()},wi=Ii.Event=be,vi=Ii.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,yi=Ii.ErrorCode=xe,Pe.COMPLETE="complete",gi=Ii.EventType=Pe,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,mi=Ii.WebChannel=ge,Ii.FetchXmlHttpFactory=Rt,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,pi=Ii.XhrIo=Ft}).apply(void 0!==Ei?Ei:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Ti="@firebase/firestore",Si="4.8.0";class Ci{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ci.UNAUTHENTICATED=new Ci(null),Ci.GOOGLE_CREDENTIALS=new Ci("google-credentials-uid"),Ci.FIRST_PARTY=new Ci("first-party-uid"),Ci.MOCK_USER=new Ci("mock-user");let Ai="11.10.0";const ki=new H("@firebase/firestore");function Ni(){return ki.logLevel}function Ri(e,...t){if(ki.logLevel<=V.DEBUG){const n=t.map(Pi);ki.debug(`Firestore (${Ai}): ${e}`,...n)}}function Oi(e,...t){if(ki.logLevel<=V.ERROR){const n=t.map(Pi);ki.error(`Firestore (${Ai}): ${e}`,...n)}}function xi(e,...t){if(ki.logLevel<=V.WARN){const n=t.map(Pi);ki.warn(`Firestore (${Ai}): ${e}`,...n)}}function Pi(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Di(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Mi(e,r,n)}function Mi(e,t,n){let r=`FIRESTORE (${Ai}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Oi(r),new Error(r)}function Li(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Mi(t,i,r)}function Fi(e,t){return e}const Vi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ui extends E{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ji{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Bi{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ki{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ci.UNAUTHENTICATED))}shutdown(){}}class Hi{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class $i{constructor(e){this.t=e,this.currentUser=Ci.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Li(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ji,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Ri("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Ri("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ji)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Ri("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Li("string"==typeof t.accessToken,31837,{l:t}),new Bi(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Li(null===e||"string"==typeof e,2055,{h:e}),new Ci(e)}}class zi{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ci.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qi{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new zi(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ci.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Gi{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wi{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$e(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Li(void 0===this.o,3512);const n=e=>{null!=e.error&&Ri("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,Ri("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Ri("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Ri("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Gi(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Li("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Gi(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Yi(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}function Qi(){return new TextEncoder}class Ji{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Yi(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Xi(e,t){return e<t?-1:e>t?1:0}function Zi(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return Xi(r,i);{const s=Qi(),o=ts(s.encode(es(e,n)),s.encode(es(t,n)));return 0!==o?o:Xi(r,i)}}n+=r>65535?2:1}return Xi(e.length,t.length)}function es(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function ts(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Xi(e[n],t[n]);return Xi(e.length,t.length)}function ns(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const rs="__name__";class is{constructor(e,t,n){void 0===t?t=0:t>e.length&&Di(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Di(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===is.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof is?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=is.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Xi(e.length,t.length)}static compareSegments(e,t){const n=is.isNumericId(e),r=is.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?is.extractNumericId(e).compare(is.extractNumericId(t)):Zi(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return li.fromString(e.substring(4,e.length-2))}}class ss extends is{construct(e,t,n){return new ss(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ui(Vi.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new ss(t)}static emptyPath(){return new ss([])}}const os=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class as extends is{construct(e,t,n){return new as(e,t,n)}static isValidIdentifier(e){return os.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),as.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===rs}static keyField(){return new as([rs])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Ui(Vi.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Ui(Vi.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ui(Vi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Ui(Vi.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new as(t)}static emptyPath(){return new as([])}}class cs{constructor(e){this.path=e}static fromPath(e){return new cs(ss.fromString(e))}static fromName(e){return new cs(ss.fromString(e).popFirst(5))}static empty(){return new cs(ss.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ss.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ss.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new cs(new ss(e.slice()))}}function us(e,t,n){if(!n)throw new Ui(Vi.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ls(e){if(!cs.isDocumentKey(e))throw new Ui(Vi.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function hs(e){if(cs.isDocumentKey(e))throw new Ui(Vi.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ds(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function fs(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Di(12329,{type:typeof e})}function ps(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ui(Vi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fs(e);throw new Ui(Vi.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function ms(e,t){const n={typeString:e};return t&&(n.value=t),n}function gs(e,t){if(!ds(e))throw new Ui(Vi.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Ui(Vi.INVALID_ARGUMENT,n);return!0}const ys=-62135596800,vs=1e6;class ws{static now(){return ws.fromMillis(Date.now())}static fromDate(e){return ws.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*vs);return new ws(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ui(Vi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ui(Vi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ys)throw new Ui(Vi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ui(Vi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vs}_compareTo(e){return this.seconds===e.seconds?Xi(this.nanoseconds,e.nanoseconds):Xi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ws._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gs(e,ws._jsonSchema))return new ws(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ys;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ws._jsonSchemaVersion="firestore/timestamp/1.0",ws._jsonSchema={type:ms("string",ws._jsonSchemaVersion),seconds:ms("number"),nanoseconds:ms("number")};class bs{static fromTimestamp(e){return new bs(e)}static min(){return new bs(new ws(0,0))}static max(){return new bs(new ws(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function _s(e){return new Es(e.readTime,e.key,-1)}class Es{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Es(bs.min(),cs.empty(),-1)}static max(){return new Es(bs.max(),cs.empty(),-1)}}function Is(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=cs.comparator(e.documentKey,t.documentKey),0!==n?n:Xi(e.largestBatchId,t.largestBatchId))}class Ts{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ss(e){if(e.code!==Vi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;Ri("LocalStore","Unexpectedly lost primary lease")}class Cs{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Di(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Cs((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Cs?t:Cs.resolve(t)}catch(e){return Cs.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Cs.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Cs.reject(t)}static resolve(e){return new Cs((t,n)=>{t(e)})}static reject(e){return new Cs((t,n)=>{n(e)})}static waitFor(e){return new Cs((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Cs.resolve(!1);for(const n of e)t=t.next(e=>e?Cs.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Cs((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next(e=>{s[c]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Cs((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function As(e){return"IndexedDbTransactionError"===e.name}class ks{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}ks.ue=-1;function Ns(e){return null==e}function Rs(e){return 0===e&&1/e==-1/0}function Os(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function xs(e){return e+""}const Ps="owner",Ds="mutationQueues",Ms="mutations",Ls="documentMutations",Fs="remoteDocumentGlobal",Vs="targets",Us="targetDocuments",js="targetGlobal",Bs="collectionParents",Ks="clientMetadata",Hs="bundles",$s="namedQueries";function zs(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function qs(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Gs(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ws{constructor(e,t){this.comparator=e,this.root=t||Qs.EMPTY}insert(e,t){return new Ws(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qs.BLACK,null,null))}remove(e){return new Ws(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ys(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ys(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ys(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ys(this.root,e,this.comparator,!0)}}class Ys{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Qs.RED,this.left=null!=r?r:Qs.EMPTY,this.right=null!=i?i:Qs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Qs(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Qs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Qs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Di(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Di(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Di(27949);return e+(this.isRed()?0:1)}}Qs.EMPTY=null,Qs.RED=!0,Qs.BLACK=!1,Qs.EMPTY=new class{constructor(){this.size=0}get key(){throw Di(57766)}get value(){throw Di(16141)}get color(){throw Di(16727)}get left(){throw Di(29726)}get right(){throw Di(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Qs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Js{constructor(e){this.comparator=e,this.data=new Ws(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Xs(this.data.getIterator())}getIteratorFrom(e){return new Xs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Js))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Js(this.comparator);return t.data=e,t}}class Xs{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Zs{constructor(e){this.fields=e,e.sort(as.comparator)}static empty(){return new Zs([])}unionWith(e){let t=new Js(as.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Zs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ns(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class eo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class to{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new eo("Invalid base64 string: "+e):e}}(e);return new to(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new to(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}to.EMPTY_BYTE_STRING=new to("");const no=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(e){if(Li(!!e,39018),"string"==typeof e){let t=0;const n=no.exec(e);if(Li(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:io(e.seconds),nanos:io(e.nanos)}}function io(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function so(e){return"string"==typeof e?to.fromBase64String(e):to.fromUint8Array(e)}const oo="server_timestamp",ao="__type__",co="__previous_value__",uo="__local_write_time__";function lo(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[ao])||void 0===n?void 0:n.stringValue)===oo}function ho(e){const t=e.mapValue.fields[co];return lo(t)?ho(t):t}function fo(e){const t=ro(e.mapValue.fields[uo].timestampValue);return new ws(t.seconds,t.nanos)}class po{constructor(e,t,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=u}}const mo="(default)";class go{constructor(e,t){this.projectId=e,this.database=t||mo}static empty(){return new go("","")}get isDefaultDatabase(){return this.database===mo}isEqual(e){return e instanceof go&&e.projectId===this.projectId&&e.database===this.database}}const yo="__type__",vo="__max__",wo={fields:{__type__:{stringValue:vo}}},bo="__vector__",_o="value";function Eo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lo(e)?4:Vo(e)?9007199254740991:Lo(e)?10:11:Di(28295,{value:e})}function Io(e,t){if(e===t)return!0;const n=Eo(e);if(n!==Eo(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return fo(e).isEqual(fo(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ro(e.timestampValue),r=ro(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return so(e.bytesValue).isEqual(so(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return io(e.geoPointValue.latitude)===io(t.geoPointValue.latitude)&&io(e.geoPointValue.longitude)===io(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return io(e.integerValue)===io(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=io(e.doubleValue),r=io(t.doubleValue);return n===r?Rs(n)===Rs(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ns(e.arrayValue.values||[],t.arrayValue.values||[],Io);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(zs(n)!==zs(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!Io(n[e],r[e])))return!1;return!0}(e,t);default:return Di(52216,{left:e})}}function To(e,t){return void 0!==(e.values||[]).find(e=>Io(e,t))}function So(e,t){if(e===t)return 0;const n=Eo(e),r=Eo(t);if(n!==r)return Xi(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Xi(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=io(e.integerValue||e.doubleValue),r=io(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Co(e.timestampValue,t.timestampValue);case 4:return Co(fo(e),fo(t));case 5:return Zi(e.stringValue,t.stringValue);case 6:return function(e,t){const n=so(e),r=so(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=Xi(n[e],r[e]);if(0!==t)return t}return Xi(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Xi(io(e.latitude),io(t.latitude));return 0!==n?n:Xi(io(e.longitude),io(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ao(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},c=null===(n=o[_o])||void 0===n?void 0:n.arrayValue,u=null===(r=a[_o])||void 0===r?void 0:r.arrayValue,l=Xi((null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0,(null===(s=null==u?void 0:u.values)||void 0===s?void 0:s.length)||0);return 0!==l?l:Ao(c,u)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===wo&&t===wo)return 0;if(e===wo)return 1;if(t===wo)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=Zi(r[e],s[e]);if(0!==t)return t;const o=So(n[r[e]],i[s[e]]);if(0!==o)return o}return Xi(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Di(23264,{le:n})}}function Co(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Xi(e,t);const n=ro(e),r=ro(t),i=Xi(n.seconds,r.seconds);return 0!==i?i:Xi(n.nanos,r.nanos)}function Ao(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=So(n[e],r[e]);if(t)return t}return Xi(n.length,r.length)}function ko(e){return No(e)}function No(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ro(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return so(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return cs.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=No(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${No(e.fields[i])}`;return n+"}"}(e.mapValue):Di(61005,{value:e})}function Ro(e){switch(Eo(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ho(e);return t?16+Ro(t):16;case 5:return 2*e.stringValue.length;case 6:return so(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Ro(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return qs(e.fields,(e,n)=>{t+=e.length+Ro(n)}),t}(e.mapValue);default:throw Di(13486,{value:e})}}function Oo(e){return!!e&&"integerValue"in e}function xo(e){return!!e&&"arrayValue"in e}function Po(e){return!!e&&"nullValue"in e}function Do(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Mo(e){return!!e&&"mapValue"in e}function Lo(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[yo])||void 0===n?void 0:n.stringValue)===bo}function Fo(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return qs(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Fo(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Fo(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Vo(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===vo}class Uo{constructor(e){this.value=e}static empty(){return new Uo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Mo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fo(t)}setAll(e){let t=as.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Fo(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Mo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Io(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Mo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){qs(t,(t,n)=>e[t]=n);for(const t of n)delete e[t]}clone(){return new Uo(Fo(this.value))}}function jo(e){const t=[];return qs(e.fields,(e,n)=>{const r=new as([e]);if(Mo(n)){const e=jo(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Zs(t)}class Bo{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Bo(e,0,bs.min(),bs.min(),bs.min(),Uo.empty(),0)}static newFoundDocument(e,t,n,r){return new Bo(e,1,t,bs.min(),n,r,0)}static newNoDocument(e,t){return new Bo(e,2,t,bs.min(),bs.min(),Uo.empty(),0)}static newUnknownDocument(e,t){return new Bo(e,3,t,bs.min(),bs.min(),Uo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(bs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Uo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Uo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=bs.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Bo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ko{constructor(e,t){this.position=e,this.inclusive=t}}function Ho(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?cs.comparator(cs.fromName(o.referenceValue),n.key):So(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function $o(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Io(e.position[n],t.position[n]))return!1;return!0}class zo{constructor(e,t="asc"){this.field=e,this.dir=t}}function qo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Go{}class Wo extends Go{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ta(e,t,n):"array-contains"===t?new sa(e,n):"in"===t?new oa(e,n):"not-in"===t?new aa(e,n):"array-contains-any"===t?new ca(e,n):new Wo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new na(e,n):new ra(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(So(t,this.value)):null!==t&&Eo(this.value)===Eo(t)&&this.matchesComparison(So(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Di(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yo extends Go{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Yo(e,t)}matches(e){return Qo(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Qo(e){return"and"===e.op}function Jo(e){return function(e){for(const t of e.filters)if(t instanceof Yo)return!1;return!0}(e)&&Qo(e)}function Xo(e){if(e instanceof Wo)return e.field.canonicalString()+e.op.toString()+ko(e.value);if(Jo(e))return e.filters.map(e=>Xo(e)).join(",");{const t=e.filters.map(e=>Xo(e)).join(",");return`${e.op}(${t})`}}function Zo(e,t){return e instanceof Wo?function(e,t){return t instanceof Wo&&e.op===t.op&&e.field.isEqual(t.field)&&Io(e.value,t.value)}(e,t):e instanceof Yo?function(e,t){return t instanceof Yo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Zo(n,t.filters[r]),!0)}(e,t):void Di(19439)}function ea(e){return e instanceof Wo?function(e){return`${e.field.canonicalString()} ${e.op} ${ko(e.value)}`}(e):e instanceof Yo?function(e){return e.op.toString()+" {"+e.getFilters().map(ea).join(" ,")+"}"}(e):"Filter"}class ta extends Wo{constructor(e,t,n){super(e,t,n),this.key=cs.fromName(n.referenceValue)}matches(e){const t=cs.comparator(e.key,this.key);return this.matchesComparison(t)}}class na extends Wo{constructor(e,t){super(e,"in",t),this.keys=ia(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ra extends Wo{constructor(e,t){super(e,"not-in",t),this.keys=ia(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ia(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>cs.fromName(e.referenceValue))}class sa extends Wo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xo(t)&&To(t.arrayValue,this.value)}}class oa extends Wo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&To(this.value.arrayValue,t)}}class aa extends Wo{constructor(e,t){super(e,"not-in",t)}matches(e){if(To(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!To(this.value.arrayValue,t)}}class ca extends Wo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>To(this.value.arrayValue,e))}}class ua{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Pe=null}}function la(e,t=null,n=[],r=[],i=null,s=null,o=null){return new ua(e,t,n,r,i,s,o)}function ha(e){const t=Fi(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Xo(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Ns(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ko(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ko(e)).join(",")),t.Pe=e}return t.Pe}function da(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!qo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Zo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!$o(e.startAt,t.startAt)&&$o(e.endAt,t.endAt)}function fa(e){return cs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class pa{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function ma(e){return new pa(e)}function ga(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ya(e){const t=Fi(e);if(null===t.Te){t.Te=[];const e=new Set;for(const n of t.explicitOrderBy)t.Te.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Js(as.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Te.push(new zo(r,n))}),e.has(as.keyField().canonicalString())||t.Te.push(new zo(as.keyField(),n))}return t.Te}function va(e){const t=Fi(e);return t.Ie||(t.Ie=function(e,t){if("F"===e.limitType)return la(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new zo(e.field,t)});const n=e.endAt?new Ko(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ko(e.startAt.position,e.startAt.inclusive):null;return la(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,ya(e))),t.Ie}function wa(e,t,n){return new pa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ba(e,t){return da(va(e),va(t))&&e.limitType===t.limitType}function _a(e){return`${ha(va(e))}|lt:${e.limitType}`}function Ea(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>ea(e)).join(", ")}]`),Ns(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ko(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ko(e)).join(",")),`Target(${t})`}(va(e))}; limitType=${e.limitType})`}function Ia(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):cs.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ya(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ho(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ya(e),t)||e.endAt&&!function(e,t,n){const r=Ho(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ya(e),t))}(e,t)}function Ta(e){return(t,n)=>{let r=!1;for(const i of ya(e)){const e=Sa(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Sa(e,t,n){const r=e.field.isKeyField()?cs.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?So(r,i):Di(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Di(19790,{direction:e.dir})}}class Ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){qs(this.inner,(t,n)=>{for(const[t,r]of n)e(t,r)})}isEmpty(){return Gs(this.inner)}size(){return this.innerSize}}const Aa=new Ws(cs.comparator);function ka(){return Aa}const Na=new Ws(cs.comparator);function Ra(...e){let t=Na;for(const n of e)t=t.insert(n.key,n);return t}function Oa(e){let t=Na;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function xa(){return Da()}function Pa(){return Da()}function Da(){return new Ca(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ma=new Ws(cs.comparator),La=new Js(cs.comparator);function Fa(...e){let t=La;for(const n of e)t=t.add(n);return t}const Va=new Js(Xi);function Ua(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rs(t)?"-0":t}}function ja(e){return{integerValue:""+e}}function Ba(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Rs(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?ja(t):Ua(e,t)}class Ka{constructor(){this._=void 0}}function Ha(e,t,n){return e instanceof qa?function(e,t){const n={fields:{[ao]:{stringValue:oo},[uo]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&lo(t)&&(t=ho(t)),t&&(n.fields[co]=t),{mapValue:n}}(n,t):e instanceof Ga?Wa(e,t):e instanceof Ya?Qa(e,t):function(e,t){const n=za(e,t),r=Xa(n)+Xa(e.Ee);return Oo(n)&&Oo(e.Ee)?ja(r):Ua(e.serializer,r)}(e,t)}function $a(e,t,n){return e instanceof Ga?Wa(e,t):e instanceof Ya?Qa(e,t):n}function za(e,t){return e instanceof Ja?function(e){return Oo(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class qa extends Ka{}class Ga extends Ka{constructor(e){super(),this.elements=e}}function Wa(e,t){const n=Za(t);for(const t of e.elements)n.some(e=>Io(e,t))||n.push(t);return{arrayValue:{values:n}}}class Ya extends Ka{constructor(e){super(),this.elements=e}}function Qa(e,t){let n=Za(t);for(const t of e.elements)n=n.filter(e=>!Io(e,t));return{arrayValue:{values:n}}}class Ja extends Ka{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Xa(e){return io(e.integerValue||e.doubleValue)}function Za(e){return xo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ec{constructor(e,t){this.version=e,this.transformResults=t}}class tc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tc}static exists(e){return new tc(void 0,e)}static updateTime(e){return new tc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class rc{}function ic(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new pc(e.key,tc.none()):new uc(e.key,e.data,tc.none());{const n=e.data,r=Uo.empty();let i=new Js(as.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new lc(e.key,r,new Zs(i.toArray()),tc.none())}}function sc(e,t,n){e instanceof uc?function(e,t,n){const r=e.value.clone(),i=dc(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof lc?function(e,t,n){if(!nc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=dc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(hc(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function oc(e,t,n,r){return e instanceof uc?function(e,t,n,r){if(!nc(e.precondition,t))return n;const i=e.value.clone(),s=fc(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof lc?function(e,t,n,r){if(!nc(e.precondition,t))return n;const i=fc(e.fieldTransforms,r,t),s=t.data;return s.setAll(hc(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return nc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function ac(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=za(r.transform,e||null);null!=i&&(null===n&&(n=Uo.empty()),n.set(r.field,i))}return n||null}function cc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ns(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ga&&t instanceof Ga||e instanceof Ya&&t instanceof Ya?ns(e.elements,t.elements,Io):e instanceof Ja&&t instanceof Ja?Io(e.Ee,t.Ee):e instanceof qa&&t instanceof qa}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class uc extends rc{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class lc extends rc{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function hc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function dc(e,t,n){const r=new Map;Li(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,$a(o,a,n[i]))}return r}function fc(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ha(e,s,t))}return r}class pc extends rc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mc extends rc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&sc(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=oc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=oc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Pa();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=ic(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(bs.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fa())}isEqual(e){return this.batchId===e.batchId&&ns(this.mutations,e.mutations,(e,t)=>cc(e,t))&&ns(this.baseMutations,e.baseMutations,(e,t)=>cc(e,t))}}class yc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Li(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=Ma;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new yc(e,t,n,r)}}class vc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class wc{constructor(e,t){this.count=e,this.unchangedNames=t}}var bc,_c;function Ec(e){if(void 0===e)return Oi("GRPC error has no .code"),Vi.UNKNOWN;switch(e){case bc.OK:return Vi.OK;case bc.CANCELLED:return Vi.CANCELLED;case bc.UNKNOWN:return Vi.UNKNOWN;case bc.DEADLINE_EXCEEDED:return Vi.DEADLINE_EXCEEDED;case bc.RESOURCE_EXHAUSTED:return Vi.RESOURCE_EXHAUSTED;case bc.INTERNAL:return Vi.INTERNAL;case bc.UNAVAILABLE:return Vi.UNAVAILABLE;case bc.UNAUTHENTICATED:return Vi.UNAUTHENTICATED;case bc.INVALID_ARGUMENT:return Vi.INVALID_ARGUMENT;case bc.NOT_FOUND:return Vi.NOT_FOUND;case bc.ALREADY_EXISTS:return Vi.ALREADY_EXISTS;case bc.PERMISSION_DENIED:return Vi.PERMISSION_DENIED;case bc.FAILED_PRECONDITION:return Vi.FAILED_PRECONDITION;case bc.ABORTED:return Vi.ABORTED;case bc.OUT_OF_RANGE:return Vi.OUT_OF_RANGE;case bc.UNIMPLEMENTED:return Vi.UNIMPLEMENTED;case bc.DATA_LOSS:return Vi.DATA_LOSS;default:return Di(39323,{code:e})}}(_c=bc||(bc={}))[_c.OK=0]="OK",_c[_c.CANCELLED=1]="CANCELLED",_c[_c.UNKNOWN=2]="UNKNOWN",_c[_c.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_c[_c.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_c[_c.NOT_FOUND=5]="NOT_FOUND",_c[_c.ALREADY_EXISTS=6]="ALREADY_EXISTS",_c[_c.PERMISSION_DENIED=7]="PERMISSION_DENIED",_c[_c.UNAUTHENTICATED=16]="UNAUTHENTICATED",_c[_c.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_c[_c.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_c[_c.ABORTED=10]="ABORTED",_c[_c.OUT_OF_RANGE=11]="OUT_OF_RANGE",_c[_c.UNIMPLEMENTED=12]="UNIMPLEMENTED",_c[_c.INTERNAL=13]="INTERNAL",_c[_c.UNAVAILABLE=14]="UNAVAILABLE",_c[_c.DATA_LOSS=15]="DATA_LOSS";const Ic=new li([4294967295,4294967295],0);function Tc(e){const t=Qi().encode(e),n=new hi;return n.update(t),new Uint8Array(n.digest())}function Sc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new li([n,r],0),new li([i,s],0)]}class Cc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ac(`Invalid padding: ${t}`);if(n<0)throw new Ac(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Ac(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Ac(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=li.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply(li.fromNumber(n)));return 1===r.compare(Ic)&&(r=new li([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=Tc(e),[n,r]=Sc(t);for(let e=0;e<this.hashCount;e++){const t=this.pe(n,r,e);if(!this.ye(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Cc(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.fe)return;const t=Tc(e),[n,r]=Sc(t);for(let e=0;e<this.hashCount;e++){const t=this.pe(n,r,e);this.we(t)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ac extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class kc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Nc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new kc(bs.min(),r,new Ws(Xi),ka(),Fa())}}class Nc{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Nc(n,t,Fa(),Fa(),Fa())}}class Rc{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class Oc{constructor(e,t){this.targetId=e,this.De=t}}class xc{constructor(e,t,n=to.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Pc{constructor(){this.ve=0,this.Ce=Lc(),this.Fe=to.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Fa(),t=Fa(),n=Fa();return this.Ce.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Di(38017,{changeType:i})}}),new Nc(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=Lc()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Li(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Dc{constructor(e){this.We=e,this.Ge=new Map,this.ze=ka(),this.je=Mc(),this.Je=Mc(),this.He=new Ws(Xi)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:Di(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const i=r.target;if(fa(i))if(0===n){const e=new cs(i.path);this.Xe(t,e,Bo.newNoDocument(e,bs.min()))}else Li(1===n,20013,{expectedCount:n});else{const r=this.ot(t);if(r!==n){const n=this._t(e),i=n?this.ut(n,e,r):1;if(0!==i){this.rt(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=so(n).toUint8Array()}catch(e){if(e instanceof eo)return xi("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Cc(s,r,i)}catch(e){return xi(e instanceof Ac?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.fe?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.We.lt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Xe(t,n,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((n,r)=>{const i=this.st(r);if(i){if(n.current&&fa(i.target)){const t=new cs(i.target.path);this.Tt(t).has(r)||this.It(r,t)||this.Xe(r,t,Bo.newNoDocument(t,e))}n.Ne&&(t.set(r,n.Le()),n.ke())}});let n=Fa();this.Je.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const r=new kc(e,t,this.He,this.ze,n);return this.ze=ka(),this.je=Mc(),this.Je=Mc(),this.He=new Ws(Xi),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Pc,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Js(Xi),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Js(Xi),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||Ri("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Pc),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Mc(){return new Ws(cs.comparator)}function Lc(){return new Ws(cs.comparator)}const Fc={asc:"ASCENDING",desc:"DESCENDING"},Vc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uc={and:"AND",or:"OR"};class jc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Bc(e,t){return e.useProto3Json||Ns(t)?t:{value:t}}function Kc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Hc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function $c(e,t){return Kc(e,t.toTimestamp())}function zc(e){return Li(!!e,49232),bs.fromTimestamp(function(e){const t=ro(e);return new ws(t.seconds,t.nanos)}(e))}function qc(e,t){return Gc(e,t).canonicalString()}function Gc(e,t){const n=function(e){return new ss(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Wc(e){const t=ss.fromString(e);return Li(du(t),10190,{key:t.toString()}),t}function Yc(e,t){return qc(e.databaseId,t.path)}function Qc(e,t){const n=Wc(t);if(n.get(1)!==e.databaseId.projectId)throw new Ui(Vi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ui(Vi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new cs(Zc(n))}function Jc(e,t){return qc(e.databaseId,t)}function Xc(e){return new ss(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Zc(e){return Li(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function eu(e,t,n){return{name:Yc(e,t),fields:n.value.mapValue.fields}}function tu(e,t){return{documents:[Jc(e,t.path)]}}function nu(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Jc(e,i);const s=function(e){if(0!==e.length)return lu(Yo.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:cu(e.field),direction:su(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Bc(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:i}}function ru(e){let t=function(e){const t=Wc(e);return 4===t.length?ss.emptyPath():Zc(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Li(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=iu(e);return t instanceof Yo&&Jo(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new zo(uu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Ns(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Ko(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Ko(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new pa(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",c,u)}function iu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=uu(e.unaryFilter.field);return Wo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=uu(e.unaryFilter.field);return Wo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=uu(e.unaryFilter.field);return Wo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=uu(e.unaryFilter.field);return Wo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Di(61313);default:return Di(60726)}}(e):void 0!==e.fieldFilter?function(e){return Wo.create(uu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Di(58110);default:return Di(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Yo.create(e.compositeFilter.filters.map(e=>iu(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Di(1026)}}(e.compositeFilter.op))}(e):Di(30097,{filter:e})}function su(e){return Fc[e]}function ou(e){return Vc[e]}function au(e){return Uc[e]}function cu(e){return{fieldPath:e.canonicalString()}}function uu(e){return as.fromServerFormat(e.fieldPath)}function lu(e){return e instanceof Wo?function(e){if("=="===e.op){if(Do(e.value))return{unaryFilter:{field:cu(e.field),op:"IS_NAN"}};if(Po(e.value))return{unaryFilter:{field:cu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Do(e.value))return{unaryFilter:{field:cu(e.field),op:"IS_NOT_NAN"}};if(Po(e.value))return{unaryFilter:{field:cu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cu(e.field),op:ou(e.op),value:e.value}}}(e):e instanceof Yo?function(e){const t=e.getFilters().map(e=>lu(e));return 1===t.length?t[0]:{compositeFilter:{op:au(e.op),filters:t}}}(e):Di(54877,{filter:e})}function hu(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function du(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class fu{constructor(e,t,n,r,i=bs.min(),s=bs.min(),o=to.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new fu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class pu{constructor(e){this.gt=e}}function mu(e){const t=ru({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?wa(t,t.limit,"L"):t}class gu{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(io(e.integerValue));else if("doubleValue"in e){const n=io(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),Rs(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=ro(n)),t.Mt(`${n.seconds||""}`),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(so(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?Vo(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Lo(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):Di(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const e of Object.keys(n))this.xt(e,t),this.Dt(n[e],t)}Lt(e,t){var n,r;const i=e.fields||{};this.Ct(t,53);const s=_o,o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(t,15),t.Ft(io(o)),this.xt(s,t),this.Dt(i[s],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const e of n)this.Dt(e,t)}Bt(e,t){this.Ct(t,37),cs.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}gu.Ut=new gu;class yu{constructor(){this.Dn=new vu}addToCollectionParentIndex(e,t){return this.Dn.add(t),Cs.resolve()}getCollectionParents(e,t){return Cs.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return Cs.resolve()}deleteFieldIndex(e,t){return Cs.resolve()}deleteAllFieldIndexes(e){return Cs.resolve()}createTargetIndexes(e,t){return Cs.resolve()}getDocumentsMatchingTarget(e,t){return Cs.resolve(null)}getIndexType(e,t){return Cs.resolve(0)}getFieldIndexes(e,t){return Cs.resolve([])}getNextCollectionGroupToUpdate(e){return Cs.resolve(null)}getMinOffset(e,t){return Cs.resolve(Es.min())}getMinOffsetFromCollectionGroup(e,t){return Cs.resolve(Es.min())}updateCollectionGroup(e,t,n){return Cs.resolve()}updateIndexEntries(e,t){return Cs.resolve()}}class vu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Js(ss.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Js(ss.comparator)).toArray()}}new Uint8Array(0);const wu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bu=41943040;class _u{static withCacheSize(e){return new _u(e,_u.DEFAULT_COLLECTION_PERCENTILE,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}_u.DEFAULT_COLLECTION_PERCENTILE=10,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_u.DEFAULT=new _u(bu,_u.DEFAULT_COLLECTION_PERCENTILE,_u.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_u.DISABLED=new _u(-1,0,0);class Eu{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Eu(0)}static ur(){return new Eu(-1)}}const Iu="LruGarbageCollector";function Tu([e,t],[n,r]){const i=Xi(e,n);return 0===i?Xi(t,r):i}class Su{constructor(e){this.Tr=e,this.buffer=new Js(Tu),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Tu(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Cu{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){Ri(Iu,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){As(e)?Ri(Iu,"Ignoring IndexedDB error during garbage collection: ",e):await Ss(e)}await this.Rr(3e5)})}}class Au{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Cs.resolve(ks.ue);const n=new Su(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Ri("LruGarbageCollector","Garbage collection skipped; disabled"),Cs.resolve(wu)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ri("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wu):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,i,s,o,a,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Ri("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),Ni()<=V.DEBUG&&Ri("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-u}ms`),Cs.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}class ku{constructor(){this.changes=new Ca(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Cs.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Nu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ru{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&oc(n.mutation,e,Zs.empty(),ws.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Fa()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Fa()){const r=xa();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Ra();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=xa();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Fa()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=ka();const s=Da(),o=Da();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof lc)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),oc(o.mutation,t,o.mutation.getFieldMask(),ws.now())):s.set(t.key,Zs.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Nu(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Da();let r=new Ws((e,t)=>e-t),i=Fa();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Zs.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Fa()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Pa();c.forEach(e=>{if(!i.has(e)){const r=ic(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Cs.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return cs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Cs.resolve(xa());let o=-1,a=i;return s.next(t=>Cs.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Cs.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Fa())).next(e=>({batchId:o,changes:Oa(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new cs(t)).next(e=>{let t=Ra();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Ra();return this.indexManager.getCollectionParents(e,i).next(o=>Cs.forEach(o,o=>{const a=function(e,t){return new pa(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Bo.newInvalidDocument(r)))});let n=Ra();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&oc(s.mutation,r,Zs.empty(),ws.now()),Ia(t,r)&&(n=n.insert(e,r))}),n})}}class Ou{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return Cs.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(e){return{id:e.id,version:e.version,createTime:zc(e.createTime)}}(t)),Cs.resolve()}getNamedQuery(e,t){return Cs.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(e){return{name:e.name,query:mu(e.bundledQuery),readTime:zc(e.readTime)}}(t)),Cs.resolve()}}class xu{constructor(){this.overlays=new Ws(cs.comparator),this.kr=new Map}getOverlay(e,t){return Cs.resolve(this.overlays.get(t))}getOverlays(e,t){const n=xa();return Cs.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.wt(e,t,r)}),Cs.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),Cs.resolve()}getOverlaysForCollection(e,t,n){const r=xa(),i=t.length+1,s=new cs(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Cs.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ws((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=xa(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=xa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Cs.resolve(o)}wt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new vc(t,n));let i=this.kr.get(t);void 0===i&&(i=Fa(),this.kr.set(t,i)),this.kr.set(t,i.add(n.key))}}class Pu{constructor(){this.sessionToken=to.EMPTY_BYTE_STRING}getSessionToken(e){return Cs.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Cs.resolve()}}class Du{constructor(){this.qr=new Js(Mu.Qr),this.$r=new Js(Mu.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new Mu(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new Mu(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new cs(new ss([])),n=new Mu(t,e),r=new Mu(t,e+1),i=[];return this.$r.forEachInRange([n,r],e=>{this.Wr(e),i.push(e.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new cs(new ss([])),n=new Mu(t,e),r=new Mu(t,e+1);let i=Fa();return this.$r.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Mu(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Mu{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return cs.comparator(e.key,t.key)||Xi(e.Hr,t.Hr)}static Ur(e,t){return Xi(e.Hr,t.Hr)||cs.comparator(e.key,t.key)}}class Lu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Js(Mu.Qr)}checkEmpty(e){return Cs.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new gc(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.Yr=this.Yr.add(new Mu(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Cs.resolve(s)}lookupMutationBatch(e,t){return Cs.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),i=r<0?0:r;return Cs.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Cs.resolve(0===this.mutationQueue.length?-1:this.er-1)}getAllMutationBatches(e){return Cs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Mu(t,0),r=new Mu(t,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,r],e=>{const t=this.Zr(e.Hr);i.push(t)}),Cs.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Js(Xi);return t.forEach(e=>{const t=new Mu(e,0),r=new Mu(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,r],e=>{n=n.add(e.Hr)})}),Cs.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;cs.isDocumentKey(i)||(i=i.child(""));const s=new Mu(new cs(i),0);let o=new Js(Xi);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Hr)),!0)},s),Cs.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Li(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return Cs.forEach(t.mutations,r=>{const i=new Mu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new Mu(t,0),r=this.Yr.firstAfterOrEqual(n);return Cs.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Cs.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Fu{constructor(e){this.ni=e,this.docs=new Ws(cs.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Cs.resolve(n?n.document.mutableCopy():Bo.newInvalidDocument(t))}getEntries(e,t){let n=ka();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Bo.newInvalidDocument(e))}),Cs.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ka();const s=t.path,o=new cs(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Is(_s(o),n)<=0||(r.has(o.key)||Ia(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Cs.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Di(9500)}ri(e,t){return Cs.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Vu(this)}getSize(e){return Cs.resolve(this.size)}}class Vu extends ku{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),Cs.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class Uu{constructor(e){this.persistence=e,this.ii=new Ca(e=>ha(e),da),this.lastRemoteSnapshotVersion=bs.min(),this.highestTargetId=0,this.si=0,this.oi=new Du,this.targetCount=0,this._i=Eu.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),Cs.resolve()}getLastRemoteSnapshotVersion(e){return Cs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Cs.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Cs.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),Cs.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Eu(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,Cs.resolve()}updateTargetData(e,t){return this.hr(t),Cs.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,Cs.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ii.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ii.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Cs.waitFor(i).next(()=>r)}getTargetCount(e){return Cs.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return Cs.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),Cs.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Cs.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),Cs.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return Cs.resolve(n)}containsKey(e,t){return Cs.resolve(this.oi.containsKey(t))}}class ju{constructor(e,t){this.ai={},this.overlays={},this.ui=new ks(0),this.ci=!1,this.ci=!0,this.li=new Pu,this.referenceDelegate=e(this),this.hi=new Uu(this),this.indexManager=new yu,this.remoteDocumentCache=function(e){return new Fu(e)}(e=>this.referenceDelegate.Pi(e)),this.serializer=new pu(t),this.Ti=new Ou(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new Lu(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){Ri("MemoryPersistence","Starting transaction:",e);const r=new Bu(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ei(e,t){return Cs.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class Bu extends Ts{constructor(e){super(),this.currentSequenceNumber=e}}class Ku{constructor(e){this.persistence=e,this.Ai=new Du,this.Ri=null}static Vi(e){return new Ku(e)}get mi(){if(this.Ri)return this.Ri;throw Di(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),Cs.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),Cs.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),Cs.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Cs.forEach(this.mi,n=>{const r=cs.fromPath(n);return this.fi(e,r).next(e=>{e||t.removeEntry(r,bs.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return Cs.or([()=>Cs.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hu{constructor(e,t){this.persistence=e,this.gi=new Ca(e=>function(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=xs(t)),t=Os(e.get(n),t);return xs(t)}(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=function(e,t){return new Au(e,t)}(this,t)}static Vi(e,t){return new Hu(e,t)}Ii(){}di(e){return Cs.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return Cs.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(e=>e?Cs.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ri(e,r=>this.Sr(e,r,t).next(e=>{e||(n++,i.removeEntry(r,bs.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),Cs.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),Cs.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),Cs.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),Cs.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ro(e.data.value)),t}Sr(e,t,n){return Cs.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return Cs.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class $u{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=Fa(),r=Fa();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new $u(e,t.fromCache,n,r)}}class zu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class qu{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=_()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}(b())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ps(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ys(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new zu;return this.ws(e,t,n).next(r=>{if(i.result=r,this.Rs)return this.Ss(e,t,n,r.size)})}).next(()=>i.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(Ni()<=V.DEBUG&&Ri("QueryEngine","SDK will not create cache indexes for query:",Ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Cs.resolve()):(Ni()<=V.DEBUG&&Ri("QueryEngine","Query:",Ea(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(Ni()<=V.DEBUG&&Ri("QueryEngine","The SDK decides to create cache indexes for query:",Ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,va(t))):Cs.resolve())}ps(e,t){if(ga(t))return Cs.resolve(null);let n=va(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=wa(t,null,"F"),n=va(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Fa(...r);return this.gs.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.bs(t,r);return this.Ds(t,s,i,n.readTime)?this.ps(e,wa(t,null,"F")):this.vs(e,s,t,n)}))})))}ys(e,t,n,r){return ga(t)||r.isEqual(bs.min())?Cs.resolve(null):this.gs.getDocuments(e,n).next(i=>{const s=this.bs(t,i);return this.Ds(t,s,n,r)?Cs.resolve(null):(Ni()<=V.DEBUG&&Ri("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ea(t)),this.vs(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=bs.fromTimestamp(1e9===r?new ws(n+1,0):new ws(n,r));return new Es(i,cs.empty(),t)}(r,-1)).next(e=>e))})}bs(e,t){let n=new Js(Ta(e));return t.forEach((t,r)=>{Ia(e,r)&&(n=n.add(r))}),n}Ds(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ws(e,t,n){return Ni()<=V.DEBUG&&Ri("QueryEngine","Using full collection scan to execute query:",Ea(t)),this.gs.getDocumentsMatchingQuery(e,t,Es.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Gu="LocalStore";class Wu{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Ws(Xi),this.Ms=new Ca(e=>ha(e),da),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ru(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}async function Yu(e,t){const n=Fi(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Fa();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Bs:e,removedBatchIds:i,addedBatchIds:s}))})})}function Qu(e){const t=Fi(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function Ju(e,t){const n=Fi(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}async function Xu(e,t,n){const r=Fi(e),i=r.Fs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!As(e))throw e;Ri(Gu,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function Zu(e,t,n){const r=Fi(e);let i=bs.min(),s=Fa();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Fi(e),i=r.Ms.get(n);return void 0!==i?Cs.resolve(r.Fs.get(i)):r.hi.getTargetData(t,n)}(r,e,va(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Cs.getDocumentsMatchingQuery(e,t,n?i:bs.min(),n?s:Fa())).next(e=>(function(e,t,n){let r=e.xs.get(t)||bs.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.xs.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,qs:s})))}class el{constructor(){this.activeTargetIds=Va}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tl{constructor(){this.Fo=new el,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new el,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class nl{xo(e){}shutdown(){}}const rl="ConnectivityMonitor";class il{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ri(rl,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ri(rl,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let sl=null;function ol(){return null===sl?sl=268435456+Math.round(2147483648*Math.random()):sl++,"0x"+sl.toString(16)}const al="RestConnection",cl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ul{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.Ko=this.databaseId.database===mo?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,i){const s=ol(),o=this.Go(e,t.toUriEncodedString());Ri(al,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(a,r,i);const{host:c}=new URL(o),u=m(c);return this.jo(e,o,a,n,u).then(t=>(Ri(al,`Received RPC '${e}' ${s}: `,t),t),t=>{throw xi(al,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Jo(e,t,n,r,i,s){return this.Wo(e,t,n,r,i)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ai,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=cl[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}class ll{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const hl="WebChannelConnection";class dl extends ul{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,i){const s=ol();return new Promise((i,o)=>{const a=new pi;a.setWithCredentials(!0),a.listenOnce(gi.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case yi.NO_ERROR:const t=a.getResponseJson();Ri(hl,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case yi.TIMEOUT:Ri(hl,`RPC '${e}' ${s} timed out`),o(new Ui(Vi.DEADLINE_EXCEEDED,"Request time out"));break;case yi.HTTP_ERROR:const n=a.getStatus();if(Ri(hl,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Vi).indexOf(t)>=0?t:Vi.UNKNOWN}(t.status);o(new Ui(e,t.message))}else o(new Ui(Vi.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ui(Vi.UNAVAILABLE,"Connection failed."));break;default:Di(9055,{c_:e,streamId:s,l_:a.getLastErrorCode(),h_:a.getLastError()})}}finally{Ri(hl,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(r);Ri(hl,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",c,n,15)})}P_(e,t,n){const r=ol(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=_i(),o=bi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.zo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");Ri(hl,`Creating RPC '${e}' stream ${r}: ${u}`,a);const l=s.createWebChannel(u,a);this.T_(l);let h=!1,d=!1;const f=new ll({Ho:t=>{d?Ri(hl,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(Ri(hl,`Opening RPC '${e}' stream ${r} transport.`),l.open(),h=!0),Ri(hl,`RPC '${e}' stream ${r} sending:`,t),l.send(t))},Yo:()=>l.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(l,mi.EventType.OPEN,()=>{d||(Ri(hl,`RPC '${e}' stream ${r} transport opened.`),f.s_())}),p(l,mi.EventType.CLOSE,()=>{d||(d=!0,Ri(hl,`RPC '${e}' stream ${r} transport closed`),f.__(),this.I_(l))}),p(l,mi.EventType.ERROR,t=>{d||(d=!0,xi(hl,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.__(new Ui(Vi.UNAVAILABLE,"The operation could not be completed")))}),p(l,mi.EventType.MESSAGE,t=>{var n;if(!d){const i=t.data[0];Li(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Ri(hl,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=bc[e];if(void 0!==t)return Ec(t)}(t),i=o.message;void 0===n&&(n=Vi.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.__(new Ui(n,i)),l.close()}else Ri(hl,`RPC '${e}' stream ${r} received:`,i),f.a_(i)}}),p(o,wi.STAT_EVENT,t=>{t.stat===vi.PROXY?Ri(hl,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===vi.NOPROXY&&Ri(hl,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function fl(){return"undefined"!=typeof document?document:null}function pl(e){return new jc(e,!0)}class ml{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&Ri("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const gl="PersistentStream";class yl{constructor(e,t,n,r,i,s,o,a){this.Fi=e,this.w_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new ml(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===Vi.RESOURCE_EXHAUSTED?(Oi(t.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Vi.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.b_===t&&this.W_(e,n)},t=>{e(()=>{const e=new Ui(Vi.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Ri(gl,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(Ri(gl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vl extends yl{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Di(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Li(void 0===t||"string"==typeof t,58123),to.fromBase64String(t||"")):(Li(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),to.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Vi.UNKNOWN:Ec(e.code);return new Ui(t,e.message||"")}(o);n=new xc(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Qc(e,r.document.name),s=zc(r.document.updateTime),o=r.document.createTime?zc(r.document.createTime):bs.min(),a=new Uo({mapValue:{fields:r.document.fields}}),c=Bo.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Rc(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Qc(e,r.document),s=r.readTime?zc(r.readTime):bs.min(),o=Bo.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Rc([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Qc(e,r.document),s=r.removedTargetIds||[];n=new Rc([],s,i,null)}else{if(!("filter"in t))return Di(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new wc(r,i),o=e.targetId;n=new Oc(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return bs.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?bs.min():t.readTime?zc(t.readTime):bs.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=Xc(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=fa(r)?{documents:tu(e,r)}:{query:nu(e,r).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Hc(e,t.resumeToken);const r=Bc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(bs.min())>0){n.readTime=Kc(e,t.snapshotVersion.toTimestamp());const r=Bc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Di(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=Xc(this.serializer),t.removeTarget=e,this.k_(t)}}class wl extends yl{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Li(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Li(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){Li(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(Li(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?zc(e.updateTime):zc(t);return n.isEqual(bs.min())&&(n=zc(t)),new ec(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=zc(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=Xc(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof uc)n={update:eu(e,t.key,t.value)};else if(t instanceof pc)n={delete:Yc(e,t.key)};else if(t instanceof lc)n={update:eu(e,t.key,t.data),updateMask:hu(t.fieldMask)};else{if(!(t instanceof mc))return Di(16599,{Rt:t.type});n={verify:Yc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof qa)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ga)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ya)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ja)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw Di(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:$c(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Di(27497)}(e,t.precondition)),n}(this.serializer,e))};this.k_(t)}}class bl{}class _l extends bl{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new Ui(Vi.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Wo(e,Gc(t,n),r,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Vi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ui(Vi.UNKNOWN,e.toString())})}Jo(e,t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Jo(e,Gc(t,n),r,s,o,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Vi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ui(Vi.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class El{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Oi(t),this._a=!1):Ri("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const Il="RemoteStore";class Tl{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{Pl(this)&&(Ri(Il,"Restarting streams for network reachability change."),await async function(e){const t=Fi(e);t.Ia.add(4),await Cl(t),t.Aa.set("Unknown"),t.Ia.delete(4),await Sl(t)}(this))})}),this.Aa=new El(n,r)}}async function Sl(e){if(Pl(e))for(const t of e.da)await t(!0)}async function Cl(e){for(const t of e.da)await t(!1)}function Al(e,t){const n=Fi(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),xl(n)?Ol(n):Jl(n).x_()&&Nl(n,t))}function kl(e,t){const n=Fi(e),r=Jl(n);n.Ta.delete(t),r.x_()&&Rl(n,t),0===n.Ta.size&&(r.x_()?r.B_():Pl(n)&&n.Aa.set("Unknown"))}function Nl(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(bs.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Jl(e).H_(t)}function Rl(e,t){e.Ra.$e(t),Jl(e).Y_(t)}function Ol(e){e.Ra=new Dc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),Jl(e).start(),e.Aa.aa()}function xl(e){return Pl(e)&&!Jl(e).M_()&&e.Ta.size>0}function Pl(e){return 0===Fi(e).Ia.size}function Dl(e){e.Ra=void 0}async function Ml(e){e.Aa.set("Online")}async function Ll(e){e.Ta.forEach((t,n)=>{Nl(e,t)})}async function Fl(e,t){Dl(e),xl(e)?(e.Aa.la(t),Ol(e)):e.Aa.set("Unknown")}async function Vl(e,t,n){if(e.Aa.set("Online"),t instanceof xc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ta.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ta.delete(r),e.Ra.removeTarget(r))}(e,t)}catch(n){Ri(Il,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ul(e,n)}else if(t instanceof Rc?e.Ra.Ye(t):t instanceof Oc?e.Ra.it(t):e.Ra.et(t),!n.isEqual(bs.min()))try{const t=await Qu(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ta.get(r);i&&e.Ta.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ta.get(t);if(!r)return;e.Ta.set(t,r.withResumeToken(to.EMPTY_BYTE_STRING,r.snapshotVersion)),Rl(e,t);const i=new fu(r.target,t,n,r.sequenceNumber);Nl(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ri(Il,"Failed to raise snapshot:",t),await Ul(e,t)}}async function Ul(e,t,n){if(!As(t))throw t;e.Ia.add(1),await Cl(e),e.Aa.set("Offline"),n||(n=()=>Qu(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ri(Il,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Sl(e)})}function jl(e,t){return t().catch(n=>Ul(e,n,t))}async function Bl(e){const t=Fi(e),n=Xl(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:-1;for(;Kl(t);)try{const e=await Ju(t.localStore,r);if(null===e){0===t.Pa.length&&n.B_();break}r=e.batchId,Hl(t,e)}catch(e){await Ul(t,e)}$l(t)&&zl(t)}function Kl(e){return Pl(e)&&e.Pa.length<10}function Hl(e,t){e.Pa.push(t);const n=Xl(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function $l(e){return Pl(e)&&!Xl(e).M_()&&e.Pa.length>0}function zl(e){Xl(e).start()}async function ql(e){Xl(e).na()}async function Gl(e){const t=Xl(e);for(const n of e.Pa)t.X_(n.mutations)}async function Wl(e,t,n){const r=e.Pa.shift(),i=yc.from(r,t,n);await jl(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Bl(e)}async function Yl(e,t){t&&Xl(e).Z_&&await async function(e,t){if(function(e){return function(e){switch(e){case Vi.OK:return Di(64938);case Vi.CANCELLED:case Vi.UNKNOWN:case Vi.DEADLINE_EXCEEDED:case Vi.RESOURCE_EXHAUSTED:case Vi.INTERNAL:case Vi.UNAVAILABLE:case Vi.UNAUTHENTICATED:return!1;case Vi.INVALID_ARGUMENT:case Vi.NOT_FOUND:case Vi.ALREADY_EXISTS:case Vi.PERMISSION_DENIED:case Vi.FAILED_PRECONDITION:case Vi.ABORTED:case Vi.OUT_OF_RANGE:case Vi.UNIMPLEMENTED:case Vi.DATA_LOSS:return!0;default:return Di(15467,{code:e})}}(e)&&e!==Vi.ABORTED}(t.code)){const n=e.Pa.shift();Xl(e).N_(),await jl(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Bl(e)}}(e,t),$l(e)&&zl(e)}async function Ql(e,t){const n=Fi(e);n.asyncQueue.verifyOperationInProgress(),Ri(Il,"RemoteStore received new credentials");const r=Pl(n);n.Ia.add(3),await Cl(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Sl(n)}function Jl(e){return e.Va||(e.Va=function(e,t,n){const r=Fi(e);return r.ia(),new vl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:Ml.bind(null,e),e_:Ll.bind(null,e),n_:Fl.bind(null,e),J_:Vl.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),xl(e)?Ol(e):e.Aa.set("Unknown")):(await e.Va.stop(),Dl(e))})),e.Va}function Xl(e){return e.ma||(e.ma=function(e,t,n){const r=Fi(e);return r.ia(),new wl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:ql.bind(null,e),n_:Yl.bind(null,e),ea:Gl.bind(null,e),ta:Wl.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await Bl(e)):(await e.ma.stop(),e.Pa.length>0&&(Ri(Il,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}class Zl{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Zl(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ui(Vi.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eh(e,t){if(Oi("AsyncQueue",`${t}: ${e}`),As(e))return new Ui(Vi.UNAVAILABLE,`${t}: ${e}`);throw e}class th{static emptySet(e){return new th(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||cs.comparator(t.key,n.key):(e,t)=>cs.comparator(e.key,t.key),this.keyedMap=Ra(),this.sortedSet=new Ws(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof th))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new th;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class nh{constructor(){this.fa=new Ws(cs.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Di(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class rh{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new rh(e,t,th.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ba(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class ih{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class sh{constructor(){this.queries=oh(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=Fi(e),r=n.queries;n.queries=oh(),r.forEach((e,n)=>{for(const e of n.wa)e.onError(t)})}(this,new Ui(Vi.ABORTED,"Firestore shutting down"))}}function oh(){return new Ca(e=>_a(e),ba)}async function ah(e,t){const n=Fi(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.Sa()&&t.ba()&&(r=2):(s=new ih,r=t.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=eh(e,`Initialization of query '${Ea(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.wa.push(t),t.va(n.onlineState),s.ya&&t.Ca(s.ya)&&hh(n)}async function ch(e,t){const n=Fi(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.wa.indexOf(t);e>=0&&(s.wa.splice(e,1),0===s.wa.length?i=t.ba()?0:1:!s.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function uh(e,t){const n=Fi(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.wa)t.Ca(e)&&(r=!0);i.ya=e}}r&&hh(n)}function lh(e,t,n){const r=Fi(e),i=r.queries.get(t);if(i)for(const e of i.wa)e.onError(n);r.queries.delete(t)}function hh(e){e.Da.forEach(e=>{e.next()})}var dh,fh;(fh=dh||(dh={})).Fa="default",fh.Cache="cache";class ph{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new rh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=rh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==dh.Cache}}class mh{constructor(e){this.key=e}}class gh{constructor(e){this.key=e}}class yh{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Fa(),this.mutatedKeys=Fa(),this.Xa=Ta(e),this.eu=new th(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new nh,r=t?t.eu:this.eu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),l=Ia(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.iu(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Xa(l,a)>0||c&&this.Xa(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{eu:s,ru:n,Ds:o,mutatedKeys:i}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const s=e.ru.pa();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Di(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),r=null!=r&&r;const o=t&&!r?this.ou():[],a=0===this.Za.size&&this.current&&!r?1:0,c=a!==this.Ya;return this.Ya=a,0!==s.length||c?{snapshot:new rh(this.query,e.eu,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new nh,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Fa(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new gh(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new mh(n))}),t}uu(e){this.Ha=e.qs,this.Za=Fa();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return rh.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const vh="SyncEngine";class wh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class bh{constructor(e){this.key=e,this.lu=!1}}class _h{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new Ca(e=>_a(e),ba),this.Tu=new Map,this.Iu=new Set,this.du=new Ws(cs.comparator),this.Eu=new Map,this.Au=new Du,this.Ru={},this.Vu=new Map,this.mu=Eu.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function Eh(e,t,n=!0){const r=Kh(e);let i;const s=r.Pu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Th(r,t,n,!0),i}async function Ih(e,t){const n=Kh(e);await Th(n,t,!0,!1)}async function Th(e,t,n,r){const i=await function(e,t){const n=Fi(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.hi.getTargetData(e,t).next(i=>i?(r=i,Cs.resolve(r)):n.hi.allocateTargetId(e).next(i=>(r=new fu(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Fs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}(e.localStore,va(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await async function(e,t,n,r,i){e.gu=(t,n,r)=>async function(e,t,n,r){let i=t.view.nu(n);i.Ds&&(i=await Zu(e.localStore,t.query,!1).then(({documents:e})=>t.view.nu(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Lh(e,t.targetId,a._u),a.snapshot}(e,t,n,r);const s=await Zu(e.localStore,t,!0),o=new yh(t,s.qs),a=o.nu(s.documents),c=Nc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);Lh(e,n,u._u);const l=new wh(t,n,o);return e.Pu.set(t,l),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),u.snapshot}(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Al(e.remoteStore,i),a}async function Sh(e,t,n){const r=Fi(e),i=r.Pu.get(t),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(e=>!ba(e,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Xu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&kl(r.remoteStore,i.targetId),Dh(r,i.targetId)}).catch(Ss)):(Dh(r,i.targetId),await Xu(r.localStore,i.targetId,!0))}async function Ch(e,t){const n=Fi(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),kl(n.remoteStore,r.targetId))}async function Ah(e,t){const n=Fi(e);try{const e=await function(e,t){const n=Fi(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const o=[];t.targetChanges.forEach((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.hi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.hi.addMatchingKeys(e,s.addedDocuments,a)));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(to.EMPTY_BYTE_STRING,bs.min()).withLastLimboFreeSnapshotVersion(bs.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.hi.updateTargetData(e,u))});let a=ka(),c=Fa();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=Fa(),i=Fa();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=ka();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(bs.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Ri(Gu,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ls:r,ks:i}})}(e,s,t.documentUpdates).next(e=>{a=e.Ls,c=e.ks})),!r.isEqual(bs.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Cs.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,c)).next(()=>a)}).then(e=>(n.Fs=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Eu.get(t);r&&(Li(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.lu=!0:e.modifiedDocuments.size>0?Li(r.lu,14607):e.removedDocuments.size>0&&(Li(r.lu,42227),r.lu=!1))}),await Uh(n,e,t)}catch(e){await Ss(e)}}function kh(e,t,n){const r=Fi(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Pu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Fi(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const e of n.wa)e.va(t)&&(r=!0)}),r&&hh(n)}(r.eventManager,t),e.length&&r.hu.J_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Nh(e,t,n){const r=Fi(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),s=i&&i.key;if(s){let e=new Ws(cs.comparator);e=e.insert(s,Bo.newNoDocument(s,bs.min()));const n=Fa().add(s),i=new kc(bs.min(),new Map,new Ws(Xi),e,n);await Ah(r,i),r.du=r.du.remove(s),r.Eu.delete(t),Vh(r)}else await Xu(r.localStore,t,!1).then(()=>Dh(r,t,n)).catch(Ss)}async function Rh(e,t){const n=Fi(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Fi(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Cs.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Li(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fa();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Ph(n,r,null),xh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Uh(n,e)}catch(e){await Ss(e)}}async function Oh(e,t,n){const r=Fi(e);try{const e=await function(e,t){const n=Fi(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Li(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Ph(r,t,n),xh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Uh(r,e)}catch(n){await Ss(n)}}function xh(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function Ph(e,t,n){const r=Fi(e);let i=r.Ru[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function Dh(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||Mh(e,t)})}function Mh(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(kl(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),Vh(e))}function Lh(e,t,n){for(const r of n)r instanceof mh?(e.Au.addReference(r.key,t),Fh(e,r)):r instanceof gh?(Ri(vh,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||Mh(e,r.key)):Di(19791,{yu:r})}function Fh(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(Ri(vh,"New document in limbo: "+n),e.Iu.add(r),Vh(e))}function Vh(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new cs(ss.fromString(t)),r=e.mu.next();e.Eu.set(r,new bh(n)),e.du=e.du.insert(n,r),Al(e.remoteStore,new fu(va(ma(n.path)),r,"TargetPurposeLimboResolution",ks.ue))}}async function Uh(e,t,n){const r=Fi(e),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((e,a)=>{o.push(r.gu(a,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=$u.Es(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.hu.J_(i),await async function(e,t){const n=Fi(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Cs.forEach(t,t=>Cs.forEach(t.Is,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Cs.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!As(e))throw e;Ri(Gu,"Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Fs.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(t,i)}}}(r.localStore,s))}async function jh(e,t){const n=Fi(e);if(!n.currentUser.isEqual(t)){Ri(vh,"User change. New user:",t.toKey());const e=await Yu(n.localStore,t);n.currentUser=t,function(e){e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new Ui(Vi.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Vu.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Uh(n,e.Bs)}}function Bh(e,t){const n=Fi(e),r=n.Eu.get(t);if(r&&r.lu)return Fa().add(r.key);{let e=Fa();const r=n.Tu.get(t);if(!r)return e;for(const t of r){const r=n.Pu.get(t);e=e.unionWith(r.view.tu)}return e}}function Kh(e){const t=Fi(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ah.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Nh.bind(null,t),t.hu.J_=uh.bind(null,t.eventManager),t.hu.pu=lh.bind(null,t.eventManager),t}function Hh(e){const t=Fi(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Rh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Oh.bind(null,t),t}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pl(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return function(e,t,n,r){return new Wu(e,t,n,r)}(this.persistence,new qu,e.initialUser,this.serializer)}Du(e){return new ju(Ku.Vi,this.serializer)}bu(e){return new tl}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class zh extends $h{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Li(this.persistence.referenceDelegate instanceof Hu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Cu(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?_u.withCacheSize(this.cacheSizeBytes):_u.DEFAULT;return new ju(e=>Hu.Vi(e,t),this.serializer)}}class qh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>kh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=jh.bind(null,this.syncEngine),await async function(e,t){const n=Fi(e);t?(n.Ia.delete(2),await Sl(n)):t||(n.Ia.add(2),await Cl(n),n.Aa.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new sh}createDatastore(e){const t=pl(e.databaseInfo.databaseId),n=function(e){return new dl(e)}(e.databaseInfo);return function(e,t,n,r){return new _l(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Tl(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>kh(this.syncEngine,e,0),il.C()?new il:new nl)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new _h(e,t,n,r,i,s);return o&&(a.fu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Fi(e);Ri(Il,"RemoteStore shutting down."),t.Ia.add(5),await Cl(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}qh.provider={build:()=>new qh};class Gh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Wh="FirestoreClient";class Yh{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ci.UNAUTHENTICATED,this.clientId=Ji.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Ri(Wh,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Ri(Wh,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=eh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qh(e,t){e.asyncQueue.verifyOperationInProgress(),Ri(Wh,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Yu(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>{xi("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{Ri("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{xi("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function Jh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ri(Wh,"Using user provided OfflineComponentProvider");try{await Qh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Vi.FAILED_PRECONDITION||e.code===Vi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;xi("Error using user provided cache. Falling back to memory cache: "+n),await Qh(e,new $h)}}else Ri(Wh,"Using default OfflineComponentProvider"),await Qh(e,new zh(void 0));return e._offlineComponents}(e);Ri(Wh,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Ql(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Ql(t.remoteStore,n)),e._onlineComponents=t}async function Xh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ri(Wh,"Using user provided OnlineComponentProvider"),await Jh(e,e._uninitializedComponentsProvider._online)):(Ri(Wh,"Using default OnlineComponentProvider"),await Jh(e,new qh))),e._onlineComponents}async function Zh(e){const t=await Xh(e),n=t.eventManager;return n.onListen=Eh.bind(null,t.syncEngine),n.onUnlisten=Sh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Ih.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Ch.bind(null,t.syncEngine),n}function ed(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const td=new Map,nd="firestore.googleapis.com",rd=!0;class id{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ui(Vi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nd,this.ssl=rd}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:rd;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=bu;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ui(Vi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Ui(Vi.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ed(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ui(Vi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Ui(Vi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Ui(Vi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sd{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new id({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ui(Vi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ui(Vi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new id(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ki;switch(e.type){case"firstParty":return new qi(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ui(Vi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=td.get(e);t&&(Ri("ComponentProvider","Removing Datastore"),td.delete(e),t.terminate())}(this),Promise.resolve()}}class od{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new od(this.firestore,e,this._query)}}class ad{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ad(this.firestore,e,this._key)}toJSON(){return{type:ad._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(gs(t,ad._jsonSchema))return new ad(e,n||null,new cs(ss.fromString(t.referencePath)))}}ad._jsonSchemaVersion="firestore/documentReference/1.0",ad._jsonSchema={type:ms("string",ad._jsonSchemaVersion),referencePath:ms("string")};class cd extends od{constructor(e,t,n){super(e,t,ma(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ad(this.firestore,null,new cs(e))}withConverter(e){return new cd(this.firestore,e,this._path)}}function ud(e,t,...n){if(e=x(e),us("collection","path",t),e instanceof sd){const r=ss.fromString(t,...n);return hs(r),new cd(e,null,r)}{if(!(e instanceof ad||e instanceof cd))throw new Ui(Vi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ss.fromString(t,...n));return hs(r),new cd(e.firestore,null,r)}}function ld(e,t,...n){if(e=x(e),1===arguments.length&&(t=Ji.newId()),us("doc","path",t),e instanceof sd){const r=ss.fromString(t,...n);return ls(r),new ad(e,null,new cs(r))}{if(!(e instanceof ad||e instanceof cd))throw new Ui(Vi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ss.fromString(t,...n));return ls(r),new ad(e.firestore,e instanceof cd?e.converter:null,new cs(r))}}const hd="AsyncQueue";class dd{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new ml(this,"async_queue_retry"),this.oc=()=>{const e=fl();e&&Ri(hd,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=fl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=fl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new ji;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!As(e))throw e;Ri(hd,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,Oi("INTERNAL UNHANDLED ERROR: ",fd(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=Zl.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(r),r}ac(){this.tc&&Di(47125,{hc:fd(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function fd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function pd(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(e)}class md extends sd{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new dd,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dd(e),this._firestoreClient=void 0,await e}}}function gd(e){if(e._terminated)throw new Ui(Vi.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new po(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ed(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Yh(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}(e),e._firestoreClient}class yd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yd(to.fromBase64String(e))}catch(e){throw new Ui(Vi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new yd(to.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yd._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gs(e,yd._jsonSchema))return yd.fromBase64String(e.bytes)}}yd._jsonSchemaVersion="firestore/bytes/1.0",yd._jsonSchema={type:ms("string",yd._jsonSchemaVersion),bytes:ms("string")};class vd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ui(Vi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new as(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class wd{constructor(e){this._methodName=e}}class bd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ui(Vi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ui(Vi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xi(this._lat,e._lat)||Xi(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bd._jsonSchemaVersion}}static fromJSON(e){if(gs(e,bd._jsonSchema))return new bd(e.latitude,e.longitude)}}bd._jsonSchemaVersion="firestore/geoPoint/1.0",bd._jsonSchema={type:ms("string",bd._jsonSchemaVersion),latitude:ms("number"),longitude:ms("number")};class _d{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:_d._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gs(e,_d._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new _d(e.vectorValues);throw new Ui(Vi.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_d._jsonSchemaVersion="firestore/vectorValue/1.0",_d._jsonSchema={type:ms("string",_d._jsonSchemaVersion),vectorValues:ms("object")};const Ed=/^__.*__$/;class Id{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new lc(e,this.data,this.fieldMask,t,this.fieldTransforms):new uc(e,this.data,t,this.fieldTransforms)}}function Td(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Di(40011,{Ec:e})}}class Sd{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Sd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Ld(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(Td(this.Ec)&&Ed.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Cd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||pl(e)}Dc(e,t,n,r=!1){return new Sd({Ec:e,methodName:t,bc:n,path:as.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ad(e){const t=e._freezeSettings(),n=pl(e._databaseId);return new Cd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function kd(e,t,n,r,i,s={}){const o=e.Dc(s.merge||s.mergeFields?2:0,t,n,i);xd("Data must be an object, but it was:",o,r);const a=Rd(r,o);let c,u;if(s.merge)c=new Zs(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Pd(t,r,n);if(!o.contains(i))throw new Ui(Vi.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Fd(e,i)||e.push(i)}c=new Zs(e),u=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,u=o.fieldTransforms;return new Id(new Uo(a),c,u)}function Nd(e,t){if(Od(e=x(e)))return xd("Unsupported field value:",t,e),Rd(e,t);if(e instanceof wd)return function(e,t){if(!Td(t.Ec))throw t.wc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.wc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Nd(i,t.yc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=x(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ba(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ws.fromDate(e);return{timestampValue:Kc(t.serializer,n)}}if(e instanceof ws){const n=new ws(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Kc(t.serializer,n)}}if(e instanceof bd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof yd)return{bytesValue:Hc(t.serializer,e._byteString)};if(e instanceof ad){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.wc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:qc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof _d)return function(e,t){return{mapValue:{fields:{[yo]:{stringValue:bo},[_o]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.wc("VectorValues must only contain numeric values.");return Ua(t.serializer,e)})}}}}}}(e,t);throw t.wc(`Unsupported field value: ${fs(e)}`)}(e,t)}function Rd(e,t){const n={};return Gs(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qs(e,(e,r)=>{const i=Nd(r,t.Vc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Od(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ws||e instanceof bd||e instanceof yd||e instanceof ad||e instanceof wd||e instanceof _d)}function xd(e,t,n){if(!Od(n)||!ds(n)){const r=fs(n);throw"an object"===r?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function Pd(e,t,n){if((t=x(t))instanceof vd)return t._internalPath;if("string"==typeof t)return Md(e,t);throw Ld("Field path arguments must be of type string or ",e,!1,void 0,n)}const Dd=new RegExp("[~\\*/\\[\\]]");function Md(e,t,n){if(t.search(Dd)>=0)throw Ld(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new vd(...t.split("."))._internalPath}catch(r){throw Ld(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Ld(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Ui(Vi.INVALID_ARGUMENT,a+e+c)}function Fd(e,t){return e.some(e=>e.isEqual(t))}class Vd{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ad(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ud(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ud extends Vd{data(){return super.data()}}function jd(e,t){return"string"==typeof t?Md(e,t):t instanceof vd?t._internalPath:t._delegate._internalPath}class Bd{convertValue(e,t="none"){switch(Eo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return io(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Di(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return qs(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[_o].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>io(e.doubleValue));return new _d(i)}convertGeoPoint(e){return new bd(io(e.latitude),io(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ho(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(fo(e));default:return null}}convertTimestamp(e){const t=ro(e);return new ws(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ss.fromString(e);Li(du(n),9688,{name:e});const r=new go(n.get(1),n.get(3)),i=new cs(n.popFirst(5));return r.isEqual(t)||Oi(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class Kd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hd extends Vd{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $d(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(jd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ui(Vi.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Hd._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Hd._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hd._jsonSchema={type:ms("string",Hd._jsonSchemaVersion),bundleSource:ms("string","DocumentSnapshot"),bundleName:ms("string"),bundle:ms("string")};class $d extends Hd{data(e={}){return super.data(e)}}class zd{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Kd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new $d(this._firestore,this._userDataWriter,n.key,n,new Kd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ui(Vi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new $d(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Kd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new $d(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Kd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:qd(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ui(Vi.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ji.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Di(61501,{type:e})}}function Gd(e){e=ps(e,ad);const t=ps(e.firestore,md);return function(e,t,n={}){const r=new ji;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Gh({next:a=>{s.Ou(),t.enqueueAndForget(()=>ch(e,o));const c=a.docs.has(n);!c&&a.fromCache?i.reject(new Ui(Vi.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&"server"===r.source?i.reject(new Ui(Vi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new ph(ma(n.path),s,{includeMetadataChanges:!0,ka:!0});return ah(e,o)}(await Zh(e),e.asyncQueue,t,n,r)),r.promise}(gd(t),e._key).then(n=>Jd(t,e,n))}zd._jsonSchemaVersion="firestore/querySnapshot/1.0",zd._jsonSchema={type:ms("string",zd._jsonSchemaVersion),bundleSource:ms("string","QuerySnapshot"),bundleName:ms("string"),bundle:ms("string")};class Wd extends Bd{constructor(e){super(),this.firestore=e}convertBytes(e){return new yd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ad(this.firestore,null,t)}}function Yd(e,t,n){e=ps(e,ad);const r=ps(e.firestore,md),i=function(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}(e.converter,t,n);return function(e,t){return function(e,t){const n=new ji;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Hh(e);try{const e=await function(e,t){const n=Fi(e),r=ws.now(),i=t.reduce((e,t)=>e.add(t.key),Fa());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=ka(),c=Fa();return n.Os.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(c=c.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=ac(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new lc(e.key,t,jo(t.value.mapValue),tc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Oa(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ru[e.currentUser.toKey()];r||(r=new Ws(Xi)),r=r.insert(t,n),e.Ru[e.currentUser.toKey()]=r}(r,e.batchId,n),await Uh(r,e.changes),await Bl(r.remoteStore)}catch(e){const t=eh(e,"Failed to persist write");n.reject(t)}}(await function(e){return Xh(e).then(e=>e.syncEngine)}(e),t,n)),n.promise}(gd(e),t)}(r,[kd(Ad(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,tc.none())])}function Qd(e,...t){var n,r,i;e=x(e);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof t[o]||pd(t[o])||(s=t[o++]);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(pd(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof ad)u=ps(e.firestore,md),l=ma(e._key.path),c={next:n=>{t[o]&&t[o](Jd(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=ps(e,od);u=ps(n.firestore,md),l=n._query;const r=new Wd(u);c={next:e=>{t[o]&&t[o](new zd(u,r,n,e))},error:t[o+1],complete:t[o+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ui(Vi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,r){const i=new Gh(r),s=new ph(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>ah(await Zh(e),s)),()=>{i.Ou(),e.asyncQueue.enqueueAndForget(async()=>ch(await Zh(e),s))}}(gd(u),l,a,c)}function Jd(e,t,n){const r=n.docs.get(t._key),i=new Wd(e);return new Hd(e,i,t._key,r,new Kd(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap,function(e,t=!0){!function(e){Ai=e}(Ge),Ke(new P("firestore",(e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new md(new $i(e.getProvider("auth-internal")),new Wi(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ui(Vi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new go(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),Qe(Ti,Si,e),Qe(Ti,Si,"esm2017")}();var Xd=function(){var e=t(i().mark(function e(t,n,r){var s,o,a,c,u;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=ld(n,"users",t),e.next=1,Gd(o);case 1:if((a=e.sent).exists()||alert("Kullanıcı bilgileri bulunamadı!"),c=a.data(),u=null!==(s=c.expireDate)&&void 0!==s&&s.toDate?c.expireDate.toDate():new Date(c.expireDate),!(new Date>u)){e.next=2;break}return alert("Hesabınızın süresi dolmuş. Lütfen yönetici ile iletişime geçin."),e.next=2,Zn(r);case 2:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),Zd=(n(5133),[{id:"HAS",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!0,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"BILEZIK22",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.912,satisMilyem:.93,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"AYAR8",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.32,satisMilyem:0,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"AYAR14",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.575,satisMilyem:0,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"AYAR18",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.7,satisMilyem:0,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"AYAR22",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.912,satisMilyem:.93,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"AYAR24",haremId:"ALTIN",haremAlis:0,haremSatis:0,alisMilyem:.995,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"CEYREK_YENI",haremId:"CEYREK_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"CEYREK_ESKI",haremId:"CEYREK_ESKI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"YARIM_YENI",haremId:"YARIM_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"YARIM_ESKI",haremId:"YARIM_ESKI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"TEK_ESKI",haremId:"TEK_ESKI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"TEK_YENI",haremId:"TEK_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"ATA_YENI",haremId:"ATA_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"RESAT",haremId:"ATA_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"GRAMESE_YENI",haremId:"CEYREK_YENI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return 10*Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return 10*Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"GRAMESE_ESKI",haremId:"CEYREK_ESKI",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!1,alisHesap:function(){return 10*Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return 10*Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"USDTRY",haremId:"USDTRY",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!0,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"EURTRY",haremId:"EURTRY",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,format:!0,alisHesap:function(){return Number(this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(this.haremSatis)*this.satisMilyem+Number(this.satisKar)}},{id:"GUMUSTRY",haremId:"GUMUSTRY",haremAlis:0,haremSatis:0,alisMilyem:1,satisMilyem:1,alisKar:0,satisKar:0,alisHesap:function(){return Number(1e3*this.haremAlis)*this.alisMilyem+Number(this.alisKar)},satisHesap:function(){return Number(1e3*this.haremSatis)*this.satisMilyem+Number(this.satisKar)}}]);function ef(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tf(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tf(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function tf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n(7231),n(8098),n(7234),n(1724),n(6216),n(6903),n(7933),n(4845),n(6345),n(5503),n(4202),n(2580),n(5185),n(6657),n(8700),n(5535),n(3111),n(8070);var nf=function(){var e=t(i().mark(function e(t,n,r){var s,o,a,c,u,l,h,d;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,s=ef(r),e.prev=1,s.s();case 2:if((o=s.n()).done){e.next=5;break}if("HAS"!==(a=o.value).id){e.next=3;break}return e.abrupt("continue",4);case 3:return c=parseFloat(document.getElementById("alis_".concat(a.id)).value||0),u=parseFloat(document.getElementById("satis_".concat(a.id)).value||0),l=ld(n,"users",t,"prices",a.id),e.next=4,Yd(l,{alis:c,satis:u},{merge:!0});case 4:e.next=2;break;case 5:e.next=7;break;case 6:e.prev=6,h=e.catch(1),s.e(h);case 7:return e.prev=7,s.f(),e.finish(7);case 8:alert("✅ Fiyatlar başarıyla kaydedildi!"),window.location.href="../livePrices/livePrices.html",e.next=10;break;case 9:e.prev=9,d=e.catch(0),console.error("❌ Fiyat kaydı hatası:",d),alert("Hata oluştu: "+d.message);case 10:case"end":return e.stop()}},e,null,[[0,9],[1,6,7,8]])}));return function(t,n,r){return e.apply(this,arguments)}}(),rf=function(){var e=t(i().mark(function e(t,n,r){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{Qd(ud(n,"users",t,"prices"),function(e){var t={};e.forEach(function(e){t[e.id]=e.data()}),r.forEach(function(e){t[e.id]||(t[e.id]={alis:0,satis:0})}),sf(t,r)},function(e){console.error("❌ Fiyat dinleyici hatası:",e),alert("Fiyatlar dinlenemiyor: "+e.message)})}catch(e){console.error("❌ Fiyat dinleyici kurulurken hata:",e),alert("Fiyat dinleyici kurulamadı: "+e.message)}case 1:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),sf=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(arguments.length>1?arguments[1]:void 0).forEach(function(t){var n,r,i=document.getElementById(t.id);if(i){var s=i.querySelector(".alis"),o=i.querySelector(".satis"),a=(null===(n=e[t.id])||void 0===n?void 0:n.alis)||0,c=(null===(r=e[t.id])||void 0===r?void 0:r.satis)||0;s.innerHTML='\n      <input type="number" class="form-control" id="alis_'.concat(t.id,'" value="').concat(a,'" placeholder="').concat(t.alisMilyem,'" max="0">\n    '),o.innerHTML='\n      <input type="number" class="form-control" id="satis_'.concat(t.id,'" value="').concat(c,'" placeholder="').concat(t.satisMilyem,'">\n    '),document.getElementById("alis_".concat(t.id)).addEventListener("input",function(){var e=this.value;""!==e&&"-"!==e?e.startsWith("-")||(this.value="-"+e.replace(/-/g,"")):this.value="-"})}})},of=(n(709),function(e,t){e.innerHTML=t?e.innerHTML.concat('\n      <button id="saveBtn" class="backgroundColor">💾 Kaydet</button>\n      <button id="adminPanelBtn" class="newUserBtn backgroundColor">Admin Paneli</button>\n      <button id="homeBtn" class="homeBtn backgroundColor">🏠 Ana Sayfa</button>\n      <button id="addImage" class="addImage backgroundColor">Logo Yükle</button>\n      <button id="logoutBtn" class="logoutBtn backgroundColor">🔒 Çıkış Yap</button>\n    '):e.innerHTML.concat('\n      <button id="saveBtn" class="backgroundColor">💾 Kaydet</button>\n      <button id="homeBtn" class="homeBtn backgroundColor">🏠 Ana Sayfa</button>\n      <button id="addImage" class="addImage backgroundColor">Logo Yükle</button>\n      <button id="logoutBtn" class="logoutBtn backgroundColor">🔒 Çıkış Yap</button>\n    ')});setInterval(function(){var e,t,n,r,i=document.querySelector(".timeContainer");i&&(i.textContent="".concat((e=new Date,t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0"),"".concat(t,":").concat(n,":").concat(r))))},1e3),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("goToUpdateBtn");e&&e.addEventListener("click",function(){window.location.href="../updatePrices/updatePrices.html"})});var af=We({apiKey:"AIzaSyDIGME8_6gN9bI1SCadrsx93QhQRCfC-dM",authDomain:"canli-altin-app.firebaseapp.com",databaseURL:"https://canli-altin-app-default-rtdb.europe-west1.firebasedatabase.app",projectId:"canli-altin-app",storageBucket:"canli-altin-app.firebasestorage.app",messagingSenderId:"675863034125",appId:"1:675863034125:web:301006180c35a5f0549844",measurementId:"G-V3YHGPSB8M"}),cf=function(e=Ye()){const t=He(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=He(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(S(n.getOptions(),null!=t?t:{}))return e;ht(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ri,persistence:[_r,ir,or]}),r=f("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ai)return;const r=null==t?void 0:t.token;ci!==r&&(ci=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){x(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e){x(e).onIdTokenChanged(e=>t(e),void 0,void 0)}(n)}}var i;const s=h("auth");return s&&function(e,t,n){const r=wn(e);gt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Rn(t),{host:o,port:a}=function(e){const t=Rn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:On(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:On(t)}}}(t),c=null===a?"":`:${a}`,u={url:`${s}//${o}${c}/`},l=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return gt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void gt(S(u,r.config.emulator)&&S(l,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=u,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,m(o)?(g(`${s}//${o}${c}`),w("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}(af),uf=function(e){const t="object"==typeof e?e:Ye(),n="string"==typeof e?e:mo,r=He(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(()=>{const e=h("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();e&&function(e,t,n,r={}){var i;e=ps(e,sd);const s=m(t),o=e._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),u=`${t}:${n}`;s&&(g(`https://${u}`),w("Firestore",!0)),o.host!==nd&&o.host!==u&&xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!S(l,a)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ci.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Ui(Vi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ci(s)}e._authCredentials=new Hi(new Bi(t,n))}}(r,...e)}return r}(af);!function(e,t){x(e).onAuthStateChanged(t,void 0,void 0)}(cf,function(){var e=t(i().mark(function e(n){var r,s,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=1;break}return window.location.href="../index.html",e.abrupt("return");case 1:return e.next=2,Xd(n.uid,uf,cf);case 2:return r=ld(uf,"admins",n.uid),e.next=3,Gd(r);case 3:return s=e.sent,o=document.getElementById("topButtons"),of(o,s.exists()),document.getElementById("logoutBtn").addEventListener("click",function(){Zn(cf).then(function(){return window.location.href="../index.html"}).catch(function(e){return alert("Çıkış hatası: "+e.message)})}),document.getElementById("adminPanelBtn")&&document.getElementById("adminPanelBtn").addEventListener("click",function(){window.location.href="../adminPanel/adminPanel.html"}),document.getElementById("addImage").addEventListener("click",function(){window.location.href="../uploadLogos/uploadLogos.html"}),document.getElementById("homeBtn").addEventListener("click",function(){window.location.href="../livePrices/livePrices.html"}),document.getElementById("saveBtn").addEventListener("click",t(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,nf(n.uid,uf,Zd);case 1:case"end":return e.stop()}},e)}))),e.next=4,rf(n.uid,uf,Zd);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),setInterval(t(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Xd(uid,uf,cf);case 1:case"end":return e.stop()}},e)})),3e5)})()})();